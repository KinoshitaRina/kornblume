import{o as T}from"./index-ufsH-D4G.js";import{h as ae,o as h,c as g,a as e,n as z,d as y,i as R,w as X,v as ue,F as L,r as G,e as S,t as C,u as U,j as D,k as pe,b as Y,f as W,l as me,_ as de,m as Me,p as _e,q as B,s as be,x as xe,y as $e}from"./index-ZlfrwSWL.js";const Oe=ae("planner",{state:()=>({selectedArcanists:[]}),persist:!0}),Ne=ae("wilderness",{state:()=>({settings:{dust1:6,dust2:6,dust3:6,gold1:6,gold2:6,gold3:6,vigor:0,lazyModo:!1,wildernessOutput:{dust:19440,gold:8640}}}),persist:!0}),Le=ae("plannerSettings",{state:()=>({settings:{showUnreleased:!1}}),persist:!0}),Ve=["data-tip"],De={class:"rounded-md overflow-hidden"},je={class:"avatar"},Ue=["src","alt"],Ae={__name:"ArcanistIcon",props:{arcanist:{type:Object,required:!0}},setup(t){const a=s=>`images/arcanists/icon/${s}.png`;return(s,l)=>(h(),g("div",{class:"tooltip","data-tip":t.arcanist.Name},[e("div",De,[e("div",je,[e("div",{class:z(["w-10 rounded",{"bg-orange-300":t.arcanist.Rarity===6,"bg-yellow-100":t.arcanist.Rarity===5,"bg-purple-400":t.arcanist.Rarity===4,"bg-sky-200":t.arcanist.Rarity===3,"bg-green-200":t.arcanist.Rarity===2}])},[e("img",{src:a(t.arcanist.Id),alt:t.arcanist.Name},null,8,Ue)],2)])])],8,Ve))}},qe={class:"list-overlay"},Pe={class:"custom-modal-small h-2/3"},Be={class:"relative mb-4"},We=e("i",{class:"fas fa-times"},null,-1),Ge=[We],Qe={class:"p-2 overflow-y-auto h-5/6"},Ee=["onClick"],Fe={class:"text-white ml-8"},Te={__name:"ArcanistList",props:{arcanists:{type:Array,required:!0}},emits:{closeOverlay:{type:Function,required:!0},selectArcanist:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,l=a,n=c=>{l("selectArcanist",c),o()},o=()=>{l("closeOverlay")},m=y(""),u=R(()=>s.arcanists.filter(c=>c.Name.toLowerCase().includes(m.value.toLowerCase())));return(c,r)=>(h(),g("div",qe,[e("div",Pe,[e("div",Be,[X(e("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>m.value=i),type:"text",placeholder:"Search Arcanists",class:"bg-gray-800 text-white p-2 rounded-md w-11/12 focus:outline-none"},null,512),[[ue,m.value]]),e("button",{onClick:o,class:"absolute top-2 right-0 text-white"},Ge)]),e("div",Qe,[(h(!0),g(L,null,G(u.value,i=>(h(),g("div",{key:i.Id,onClick:d=>n(i),class:"p-4 flex items-center cursor-pointer hover:bg-gray-700 transition-colors"},[S(Ae,{arcanist:i},null,8,["arcanist"]),e("span",Fe,C(i.Name),1)],8,Ee))),128))])])]))}},ge=U().items.data;function re(t){return t>1e6?`${(t/1e6).toFixed(1)}m`:t>1e4?`${(t/1e3).toFixed(0)}k`:t.toString()}function ke(t){const a=m=>{const u=ge.find(c=>c.Name==m);return u?u.Id:null},s=m=>{const u=ge.find(c=>c.Name==m);return u?u.Rarity:null},l=m=>{const u=a(m);return u?`images/items/icon/${u}.png`:null},n=m=>{const u=s(m);return u?`images/items/border/${u}.png`:null};return{material:t.Material,quantity:re(t.Quantity),itemImagePath:l(t.Material),borderImagePath:n(t.Material)}}const ze=["data-tip"],Ke={class:"relative inline-block"},He=["src"],Je=["src"],Xe={class:"absolute text-white bottom-4 right-3 bg-gray-700 rounded-tl px-1 py-px text-xs"},we={__name:"ItemIcon",props:{material:{type:Object,required:!0}},setup(t){const a=t,s=R(()=>ke(a.material));return(l,n)=>(h(),g("div",{class:"tooltip","data-tip":s.value.material},[e("div",Ke,[e("img",{src:s.value.borderImagePath,alt:"Border Image",class:"w-20 h-20 absolute object-contain"},null,8,He),e("img",{src:s.value.itemImagePath,alt:"Material Image",class:"w-20 h-20 object-contain"},null,8,Je),e("div",Xe,C(s.value.quantity),1)])],8,ze))}},Ye={class:"custom-scrollbar pt-10 flex flex-wrap justify-center overflow-y-scroll overflow-x-hidden"},Ze={__name:"ItemList",props:{materialList:{type:Array,required:!0}},setup(t){const a=t;return(s,l)=>(h(),g("div",Ye,[(h(!0),g(L,null,G(a.materialList,n=>(h(),D(we,{key:n,material:n},null,8,["material"]))),128))]))}},et=U().calculations.data,fe=U().items.data;function Ie(t){t.sort((a,s)=>{const l=fe.find(c=>c.Name===a.Material),n=fe.find(c=>c.Name===s.Material),o=["Base Item","Resonate Material","Insight Material","Build Material"],m=o.indexOf(l.Category),u=o.indexOf(n.Category);return m!==u?m-u:n.Rarity!==l.Rarity?n.Rarity-l.Rarity:l.Name.localeCompare(n.Name)})}function Ce(t){const a={};return t.forEach(l=>{l&&(Array.isArray(l)?l.flat().forEach(({Material:o,Quantity:m})=>{a[o]?a[o]+=m:a[o]=m}):typeof l=="object"&&Object.entries(l).forEach(([n,o])=>{a[n]?a[n]+=o:a[n]=o}))}),Object.keys(a).map(l=>({Material:l,Quantity:a[l]}))}function tt(t){var l,n;Ie(t);const a=((l=t.find(o=>o.Material==="Dust"))==null?void 0:l.Quantity)||0,s=((n=t.find(o=>o.Material==="Sharpodonty"))==null?void 0:n.Quantity)||0;return a===0&&s===0?t.filter(m=>m.Material!=="Dust"&&m.Material!=="Sharpodonty"):t}function Se(t){const a=i=>{let d={Dust:0,Sharpodonty:0};if(i.currentInsight==i.goalInsight){const{Dust:v,Sharpodonty:x}=n(i.currentLevel,i.goalLevel,i,i.currentInsight);return d.Dust+=v,d.Sharpodonty+=x,d}for(let v=i.currentInsight;v<=i.goalInsight;v++)if(v<i.goalInsight){const x=l(i,v);if(d.Dust+=x.Total.Dust,d.Sharpodonty+=x.Total.Sharpodonty,v==i.currentInsight){const{Dust:p,Sharpodonty:$}=n(1,i.currentLevel,i,v);d.Dust-=p,d.Sharpodonty-=$}}else{const{Dust:x,Sharpodonty:p}=n(1,i.goalLevel,i,v);d.Dust+=x,d.Sharpodonty+=p}return[{Material:"Dust",Quantity:d.Dust},{Material:"Sharpodonty",Quantity:d.Sharpodonty}]},s=(i,d,b)=>{const v={};if(i===d)return null;for(let p=Number(i+1);p<=d;p++){const $=b.find(k=>k.Id===p);$&&$.Material.forEach((k,M)=>{const V=$.Quantity[M];v[k]?v[k]+=V:v[k]=V})}return Object.keys(v).map(p=>({Material:p,Quantity:v[p]}))},l=(i,d)=>et.find(v=>v.Rarity.includes(i.info.Rarity)&&v.Insight==d),n=(i,d,b,v)=>{let x={Dust:0,Sharpodonty:0};for(let p=Number(++i);p<=Number(d);p++){const $=l(b,v),k=p.toString(),M=$.Levels[k];M&&(x.Dust+=M.Dust,x.Sharpodonty+=M.Sharpodonty)}return x},o=s(t.currentInsight,t.goalInsight,t.info.Insight),m=s(t.currentResonance,t.goalResonance,t.info.Resonance),u=a(t),c=Ce([o,m,u]);return tt(c)}const st={__name:"ArcanistCalculate",props:{arcanist:{type:Object,required:!0}},setup(t){const a=t,s=R(()=>{const l=a.arcanist;return Se(l)});return(l,n)=>(h(),g("div",null,[S(Ze,{class:"max-h-48",materialList:s.value},null,8,["materialList"])]))}},at={class:"relative w-2/3 md:w-1/3 flex justify-center"},lt={key:0},nt=e("i",{class:"fa-regular fa-circle text-white"},null,-1),it=[nt],ot={key:1},rt=["src","alt"],ct=e("div",{class:"flex items-center justify-center"},[e("i",{class:"fa-solid fa-caret-up text-blue-500"})],-1),ut={class:"grid grid-cols-4 gap-1 p-3 border border-blue-300 rounded-md shadow-lg options-box custom-gradient-gray-blue"},dt=["onClick"],vt={class:"flex items-center justify-center font-semibold rounded-full w-8 h-8 leading-none flex-col bg-blue-500 text-white"},ht={key:0},mt=e("i",{class:"fa-regular fa-circle text-white"},null,-1),gt=[mt],ft={key:1},yt=["src","alt"],N={__name:"SelectList",props:{label:{type:String,required:!0},options:{type:Array,required:!0},selected:{type:Number}},emits:["update:selected"],setup(t,{emit:a}){const s=t,l=a,n=y(!1),o=y(s.selected),m=y(null),u=()=>{n.value=!0},c=()=>{n.value=!1},r=d=>{o.value=d,l("update:selected",d,s.label),n.value=!1},i=d=>`images/items/common/insight${d}.png`;return T(m,c),pe(()=>{s.selected===void 0?(o.value=s.options[0],l("update:selected",s.options[0],s.label)):(o.value=s.selected,l("update:selected",s.selected,s.label))}),(d,b)=>(h(),g("div",at,[e("button",{onClick:u,class:"btn btn-sm btn-ghost gradient-blue w-1/2 m-2"},[t.label==="Current Insight"||t.label==="Goal Insight"?(h(),g(L,{key:0},[o.value===0?(h(),g("div",lt,it)):(h(),g("div",ot,[e("img",{class:"avatar w-6",src:i(o.value),alt:"Option "+o.value},null,8,rt)]))],64)):(h(),g(L,{key:1},[Y(C(o.value),1)],64))]),n.value?(h(),g("div",{key:0,ref_key:"containerRef",ref:m,class:"absolute mt-14 w-48 lg:w-64 z-50"},[ct,e("div",ut,[(h(!0),g(L,null,G(t.options,v=>(h(),g("button",{key:v,class:"m-1",onClick:x=>r(v)},[e("div",vt,[t.label==="Current Insight"||t.label==="Goal Insight"?(h(),g(L,{key:0},[v===0?(h(),g("div",ht,gt)):(h(),g("div",ft,[e("img",{src:i(v),alt:"Option "+v},null,8,yt)]))],64)):(h(),g(L,{key:1},[Y(C(v),1)],64))])],8,dt))),128))])],512)):W("",!0)]))}},pt={class:"edit-overlay"},_t={class:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-gray-800 to-blue-950 p-4 border-2 border-black rounded-md w-11/12 sm:max-w-2xl lg:h-auto"},bt={class:"flex items-center p-2 mb-3 shadow-border-b"},xt={class:"flex items-center justify-center mr-2 space-x-3"},$t={class:"text-1xl md:text-2xl text-white font-bold"},At={class:"text-sm text-white",for:"raritySelect"},kt={class:"ml-auto flex items-center space-x-3"},wt={class:"tooltip","data-tip":"Hidden / Show"},It=e("i",{class:"fas fa-times"},null,-1),Ct=[It],St=e("div",{class:"custom-line"},null,-1),Rt=e("div",{class:"custom-label text-blue-100"},"Current Level",-1),Mt={class:"mt-2 flex justify-center items-center leading-none"},Ot=e("i",{class:"text-white text-center flex items-center justify-center font-extrabold text-2xl -translate-y-2"},"_",-1),Nt=e("div",{class:"custom-label text-blue-100"},"Goal Level",-1),Lt={class:"mt-2 flex justify-center items-center leading-none"},Vt=e("i",{class:"text-white text-center flex items-center justify-center font-extrabold text-2xl -translate-y-2"},"_",-1),Dt=e("div",{class:"custom-label text-blue-100"},"Resonance",-1),jt={class:"mt-2 flex justify-center items-center leading-none"},Ut=e("i",{class:"text-white fa-solid fa-angles-right text-center"},null,-1),qt={class:"flex justify-center space-x-4"},Pt={key:0,class:"toast toast-middle toast-center"},Bt=e("div",{class:"-translate-x-3 alert alert-info bg-red-300"},[e("span",null,"Current and Goal are the same!")],-1),Wt=[Bt],Gt={__name:"PlannerEdit",props:{selectedArcanist:{type:Object,required:!0},selectedArcanists:{type:Array,required:!0},listArcanists:{type:Array,required:!0}},emits:{closeOverlay:{type:Function,required:!0},updateSelectedArcanists:{type:Function,required:!0},updateListArcanists:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,l=a,n=y(!1),o=y(0),m=U().calculations.data,u=y(s.selectedArcanist.info),c=y(s.selectedArcanists),r=y(s.listArcanists),i=y(s.selectedArcanist.currentInsight),d=y(s.selectedArcanist.currentLevel),b=y(s.selectedArcanist.currentResonance),v=y(s.selectedArcanist.goalInsight),x=y(s.selectedArcanist.goalLevel),p=y(s.selectedArcanist.goalResonance),$=y(s.selectedArcanist.isVisible),k=R(()=>({info:u.value,isVisible:$.value,currentInsight:i.value,currentLevel:d.value,goalInsight:v.value,goalLevel:x.value,currentResonance:b.value,goalResonance:p.value})),M=R(()=>u.value.Rarity),V=R(()=>[0,...u.value.Insight.map(_=>_.Id)]),w=R(()=>V.value.filter(_=>_>=i.value)),O=R(()=>{const _=m.find(f=>f.Rarity.includes(u.value.Rarity)&&f.Insight==i.value);return _?[1,...Object.keys(_.Levels).map(Number).filter(f=>f%5===0)]:[]}),j=R(()=>{if(v.value===null)return[];const _=m.find(f=>f.Rarity.includes(u.value.Rarity)&&f.Insight==v.value);return _?v.value===i.value?[1,...Object.keys(_.Levels).map(Number).filter(f=>f%5===0)].filter(f=>f>=d.value):[1,...Object.keys(_.Levels).map(Number).filter(f=>f%5===0)]:[]}),q=R(()=>{if(i.value===null)return[];if(i.value===0)return b.value=0,[0];const _=Number(i.value);if(_===0)return b.value=null,null;const f=_*5;return Array.from({length:f},(I,Q)=>Number(Q+1))}),H=R(()=>{if(v.value===null)return[];if(v.value===0)return p.value=0,[0];const _=Number(v.value),f=Number(b.value);if(_===0)return p.value=null,null;const I=f||1,Q=_*5;return Array.from({length:Q-I+1},(ve,A)=>Number(I+A))}),F=(_,f,I,Q)=>Number(_)>Number(I)?!0:Number(_)<Number(I)?!1:Number(f)>Number(Q),ne=()=>{if(i.value===v.value&&d.value===x.value&&b.value===p.value)return n.value=!0,setTimeout(()=>{n.value=!1},1e3),!0;n.value=!1},ee=()=>{if(ne())return;const _=c.value.findIndex(f=>Number(f.info.Id)===Number(k.value.info.Id));_!==-1?c.value[_]={...c.value[_],...k.value}:c.value.push(k.value),r.value=r.value.filter(f=>f.Id!==k.value.info.Id),l("updateSelectedArcanists",c.value),l("updateListArcanists",r.value),l("closeOverlay")},ie=()=>{const _=c.value.findIndex(f=>Number(f.info.Id)===Number(k.value.info.Id));_!==-1&&c.value.splice(_,1),J()},J=()=>{l("closeOverlay")},P=(_,f)=>{switch(f){case"Current Insight":i.value=_;break;case"Current Level":d.value=_;break;case"Current Resonance":b.value=_;break;case"Goal Insight":v.value=_;break;case"Goal Level":x.value=_;break;case"Goal Resonance":p.value=_;break;case"Visible":$.value=_;break}};return me([i,d,b,v,x,p],()=>{o.value+=1}),me([i,d,b],()=>{F(i.value,d.value,v.value,x.value)&&(v.value=i.value,x.value=d.value),Number(b.value)>Number(p.value)&&(p.value=b.value)}),(_,f)=>(h(),g("div",pt,[e("div",_t,[e("div",bt,[e("div",xt,[S(Ae,{class:"ml-2",arcanist:u.value},null,8,["arcanist"]),e("h2",$t,C(u.value.Name),1),e("label",At,[Y(C(M.value)+" ",1),e("i",{class:z(["fa-solid fa-star",{"text-orange-300":M.value===6,"text-yellow-100":M.value===5,"text-purple-400":M.value===4,"text-sky-200":M.value===3,"text-green-200":M.value===2}])},null,2)]),e("div",{class:"tooltip","data-tip":"Remove Arcanist"},[e("i",{onClick:ie,class:"fas fa-trash-alt text-gray-500"})])]),e("div",kt,[e("div",wt,[e("div",{onClick:f[0]||(f[0]=I=>$.value=!$.value),class:z(["badge badge-ghost",$.value?"green-badge":"red-badge"])},[e("i",{class:z($.value?"fa-regular fa-eye":"fa-regular fa-eye-slash")},null,2)],2)]),e("button",{onClick:J,class:"text-white"},Ct)])]),St,Rt,e("div",Mt,[(h(),D(N,{key:o.value,modelValue:i.value,"onUpdate:modelValue":f[1]||(f[1]=I=>i.value=I),selected:i.value,label:"Current Insight",options:V.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"])),Ot,(h(),D(N,{key:o.value,modelValue:d.value,"onUpdate:modelValue":f[2]||(f[2]=I=>d.value=I),selected:d.value,label:"Current Level",options:O.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"]))]),Nt,e("div",Lt,[(h(),D(N,{key:o.value,modelValue:v.value,"onUpdate:modelValue":f[3]||(f[3]=I=>v.value=I),selected:v.value,label:"Goal Insight",options:w.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"])),Vt,(h(),D(N,{key:o.value,modelValue:x.value,"onUpdate:modelValue":f[4]||(f[4]=I=>x.value=I),selected:x.value,label:"Goal Level",options:j.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"]))]),Dt,e("div",jt,[(h(),D(N,{key:o.value,modelValue:b.value,"onUpdate:modelValue":f[5]||(f[5]=I=>b.value=I),selected:b.value,label:"Current Resonance",options:q.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"])),Ut,(h(),D(N,{key:o.value,modelValue:p.value,"onUpdate:modelValue":f[6]||(f[6]=I=>p.value=I),selected:p.value,label:"Goal Resonance",options:H.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"]))]),e("div",qt,[e("button",{onClick:ee,class:"btn btn-success"},"Save"),n.value?(h(),g("div",Pt,Wt)):W("",!0)]),S(st,{arcanist:k.value},null,8,["arcanist"])])]))}},Qt=["data-tip"],Et={class:"rounded-md overflow-hidden"},Ft={class:"avatar"},Tt=["src","alt"],zt={__name:"ArcanistIconToggle",props:{arcanist:{type:Object,required:!0},visible:{type:Boolean,required:!0}},setup(t){const a=s=>`images/arcanists/icon/${s}.png`;return(s,l)=>(h(),g("div",{class:"tooltip","data-tip":t.arcanist.Name},[e("div",Et,[e("div",Ft,[e("div",{class:z(["w-12 rounded",{"filter-grayscale opacity-50":!t.visible,"bg-orange-300":t.arcanist.Rarity===6,"bg-yellow-100":t.arcanist.Rarity===5,"bg-purple-400":t.arcanist.Rarity===4,"bg-sky-200":t.arcanist.Rarity===3,"bg-green-200":t.arcanist.Rarity===2}])},[e("img",{src:a(t.arcanist.Id),alt:t.arcanist.Name},null,8,Tt)],2)])])],8,Qt))}},Kt=de(zt,[["__scopeId","data-v-11642327"]]),Ht={class:"flex flex-row flex-wrap justify-center space-x-2"},Jt=e("p",{class:"text-center text-slate-700 text-sm opacity-80"},"Left click to edit, right click to show / hide.",-1),Xt={__name:"PlannerSelector",props:{selectedArcanists:{type:Array,required:!0}},emits:["open-edit-overlay"],setup(t,{emit:a}){const s=t,l=a,n=y(s.selectedArcanists),o=u=>{l("open-edit-overlay",u)},m=u=>{u.isVisible=!u.isVisible};return(u,c)=>(h(),g("div",null,[e("div",Ht,[(h(!0),g(L,null,G(n.value,r=>(h(),D(Kt,{key:r.Name,arcanist:r.info,visible:r.isVisible,onClick:i=>o(r),onContextmenu:Me(i=>m(r),["prevent"])},null,8,["arcanist","visible","onClick","onContextmenu"]))),128))]),Jt]))}},E=ae("warehouse",{state:()=>({isActive:!1,data:[],loaded:!1}),actions:{toggle(){this.isActive=!this.isActive},setData(t){this.data=t},setLoaded(){this.loaded=!0},addItem(t,a){this.data.push({Material:t,Quantity:0,Category:a})},updateItem(t,a){for(let s=0;s<this.data.length;s++)if(this.data[s].Material===t){this.data[s].Quantity=a;break}},reset(){this.data=[],this.loaded=!1}},persist:!0}),Z=U().items.data,ce=U().stages.data,Yt=U().crafts.data,Zt=E().data;function es(t){const a=t.map(s=>({...s}));return a.forEach(s=>{const l=Zt.find(n=>n.Material===s.Material);l&&(s.Quantity-=l.Quantity)}),a}function ts(t){let a=t.map(l=>({...l}));const s=[];return a.forEach(l=>{const n=Yt.find(o=>o.Name===l.Material);if(n){s.push(n);for(let o=0;o<n.Material.length;o++){const m=n.Material[o],u=n.Quantity[o]*l.Quantity;u>0&&(a.find(c=>c.Material===m)?a.find(c=>c.Material===m).Quantity+=u:a.push({Material:m,Quantity:u}))}}}),a=a.filter(l=>!s.some(n=>n.Name===l.Material)),a.sort((l,n)=>{const o=Z.find(u=>u.Name===l.Material);return Z.find(u=>u.Name===n.Material).Id-o.Id}),a}function ss(t){const s=Z.find(n=>n.Name===t.Material).Rarity,l=t.Quantity;return s===3?l*40:s===4?l*100:s===5?l*250:s===6?l*1500:0}function as(t){return t==="Oneiric Shop"?"images/items/common/1.png":"images/items/common/0.png"}function Re(t,a,s,l,n){return{stage:t,runs:isNaN(a)?0:a,activity:isNaN(s)?0:s,days:isNaN(l)?0:l,materials:n,activityImagePath:as(t)}}function te(t,a){let s=a.find(l=>l.stage===t);return s||(s=Re(t,null,t==="Oneiric Shop"?0:null,null,[]),a.push(s)),s}function se(t){return t.sort((a,s)=>{const l=ce.find(o=>o.Name===a.stage),n=ce.find(o=>o.Name===s.stage);return l&&n?l.Id-n.Id:l?-1:n?1:0})}function ye(t){const a=[],s=es(t);ts(s).forEach(r=>{const i=ce.find(d=>d.Material.includes(r.Material));if(i){const d=Math.ceil(parseFloat(r.Quantity)/parseFloat(i.Quantity)),b=Math.ceil(d*i.Activity),v=(b/240).toFixed(1),x=r;if(x.Quantity>0){const p=a.findIndex($=>$.stage===i.Name);p!==-1?a[p].materials.push(x):a.push(Re(i.Name,d,b,v,[x]))}}else{const d=te("Tier 3",a),b=te("Tier 2",a),v=te("Oneiric Shop",a),x=te("Unreleased",a);if(Z.find(p=>p.Name===r.Material).Category==="Resonate Material")v.activity+=ss(r),v.materials.push(r);else{const p=Z.find(k=>k.Name===r.Material).Rarity;(p===3?d:p===2?b:x).materials.push(r)}}});const n=a.filter(r=>["The Poussiere VI","Mintage Aesthetics VI","Oneiric Shop"].includes(r.stage)&&r.materials.length>0),o=a.filter(r=>(r.stage.endsWith("II")||r.stage.endsWith("IV")||r.stage.endsWith("VI"))&&!n.some(i=>i.stage===r.stage)&&r.materials.length>0),m=a.filter(r=>!["Tier 2","Tier 3","Unreleased",...n.map(i=>i.stage),...o.map(i=>i.stage)].includes(r.stage)&&r.materials.length>0),u=a.filter(r=>["Tier 2","Tier 3","Unreleased"].includes(r.stage)&&r.materials.length>0);return[{id:0,cards:se(n)},{id:1,cards:se(o)},{id:2,cards:se(m)},{id:3,cards:se(u)}]}function ls(t){let a=0,s=0;return t.forEach(l=>{l.cards.forEach(n=>{n.days!==null&&(a+=n.activity,s+=parseFloat(n.days))})}),[a,s.toFixed(0)]}const ns={class:"bg-gray-700/40 shadow rounded flex flex-col items-center justify-between relative"},is={class:"stage text-white p-2"},os={class:"calculations w-full flex justify-center items-center bg-gradient-to-r from-blue-800/70 to-blue-900/90 text-white p-2 rounded-md"},rs={class:"border-blue-700/90 border-r pr-3"},cs={key:0},us=e("i",{class:"fa-solid fa-xmark text-xs mr-0.5"},null,-1),ds={key:1},vs={class:"pl-2"},hs=["src"],ms={class:"border-blue-700/90 border-l pl-3"},gs={class:"items-center flex"},fs={__name:"Card",props:{card:{type:Object,required:!0}},setup(t){return(a,s)=>(h(),g("div",ns,[e("div",is,[e("p",null,C(t.card.stage),1)]),e("div",os,[e("p",rs,[t.card.runs>0?(h(),g("span",cs,[us,Y(C(t.card.runs),1)])):(h(),g("span",ds,C(t.card.runs),1))]),e("p",vs,C(t.card.activity==null?"?":t.card.activity),1),e("img",{src:t.card.activityImagePath,alt:"Activity Image",class:"inline-block w-8 h-8"},null,8,hs),e("p",ms,C(t.card.days)+" "+C(t.card.days===null?"":t.card.days>1?"days":"day"),1)]),e("div",gs,[(h(!0),g(L,null,G(t.card.materials,(l,n)=>(h(),g("div",{key:n},[S(we,{material:l},null,8,["material"])]))),128))])]))}},ys={class:"w-full mb-4 flex flex-col"},ps={class:"mb-4 gap-3 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4"},_s={__name:"PlannerLayer",props:{layer:{type:Object,required:!0}},setup(t){const a=t,s=R(()=>a.layer.cards&&a.layer.cards.length>0),l=R(()=>{switch(a.layer.id){case 0:return"yellow-badge";case 1:return"indigo-badge";case 2:return"purple-badge";case 3:return"green-badge";default:return"red-badge"}}),n=R(()=>{switch(a.layer.id){case 0:return"Resources";case 1:return"Insight";case 2:return"Hard Stages";case 3:return"Miscs";default:return"Undefined"}});return(o,m)=>(h(),g("div",ys,[s.value?(h(),g("div",{key:0,class:z(["badge badge-lg badge-ghost mt-2 mb-2 w-32",l.value])},C(n.value),3)):W("",!0),e("div",ps,[(h(!0),g(L,null,G(t.layer.cards,(u,c)=>(h(),D(fs,{key:c,card:u},null,8,["card"]))),128))])]))}},bs={class:"flex flex-wrap"},xs={__name:"PlannerResult",props:{selectedArcanists:{type:Array,required:!0}},emits:["update:totalActivityAndDays"],setup(t,{emit:a}){const s=t,l=a,n=y([]),o=y([]);return _e(()=>{const m=s.selectedArcanists.map(c=>c.isVisible?Se(c):[]),u=Ce(m);n.value=u,l("update:totalActivityAndDays",ls(ye(u))),o.value=ye(u)}),(m,u)=>(h(),g("div",bs,[(h(!0),g(L,null,G(o.value,(c,r)=>(h(),D(_s,{key:r,layer:c},null,8,["layer"]))),128))]))}},$s="/Kornblume/images/items/common/0.png",As="/Kornblume/images/items/icon/55.png",ks="/Kornblume/images/items/icon/54.png",le=t=>(be("data-v-b116625d"),t=t(),xe(),t),ws={class:"flex custom-gradient-gray-blue-light px-2 py-2 md:px-4 lg:px-6 rounded-md items-center justify-center"},Is=le(()=>e("i",{class:"fa-solid fa-calculator text-white mr-3"},null,-1)),Cs={class:"tooltip flex items-center","data-tip":"Calculations hasn't been optimized"},Ss={class:"text"},Rs=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:$s,alt:"avatar"})])],-1)),Ms={class:"text pr-3"},Os={class:"tooltip","data-tip":"Wilderness Production"},Ns={class:"text"},Ls=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:As,alt:"avatar"})])],-1)),Vs={class:"tooltip","data-tip":"Wilderness Production"},Ds={class:"text"},js=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:ks,alt:"avatar"})])],-1)),Us={__name:"PlannerTotal",props:{totalActivityAndDays:{type:Array,required:!0},wildernessSettings:{type:Object,required:!0}},setup(t){return(a,s)=>(h(),g("div",ws,[Is,e("div",Cs,[e("div",Ss,C(t.totalActivityAndDays[0]),1),Rs,e("div",Ms,C(t.totalActivityAndDays[1])+" "+C(t.totalActivityAndDays[1]>1?"days":"day"),1)]),e("div",Os,[e("div",Ns,C(B(re)(t.wildernessSettings.wildernessOutput.dust*t.totalActivityAndDays[1])),1)]),Ls,e("div",Vs,[e("div",Ds,C(B(re)(t.wildernessSettings.wildernessOutput.gold*t.totalActivityAndDays[1])),1)]),js]))}},qs=de(Us,[["__scopeId","data-v-b116625d"]]),K=t=>(be("data-v-ffb65882"),t=t(),xe(),t),Ps={class:"list-overlay"},Bs={class:"custom-modal-small h-auto"},Ws=K(()=>e("i",{class:"fas fa-times"},null,-1)),Gs=[Ws],Qs=K(()=>e("div",{class:"custom-label text-yellow-100"},"Dust Bell Towers",-1)),Es={class:"grid grid-cols-3"},Fs=K(()=>e("div",{class:"custom-label text-yellow-100"},"Gold Bell Towers",-1)),Ts={class:"grid grid-cols-3"},zs=K(()=>e("div",{class:"custom-label text-yellow-100"},"Vigor",-1)),Ks={class:"grid grid-cols-2 p-2 items-center"},Hs={class:"tooltip","data-tip":"Collect once a day"},Js={class:"form-control"},Xs={class:"cursor-pointer label justify-center"},Ys=K(()=>e("span",{class:"label-text text-yellow-100 mr-3"},"Lazy Modo",-1)),Zs=["checked"],ea=K(()=>e("div",{class:"custom-label text-yellow-100"},"Output",-1)),ta={class:"grid grid-cols-2 p-2"},sa={class:"tooltip","data-tip":"Dust"},aa={class:"flex items-center justify-center gradient-blue text-center rounded-xl mx-5 lg:mx-2 h-8"},la={class:"tooltip","data-tip":"Sharpodonty"},na={class:"flex items-center justify-center gradient-blue text-center rounded-xl mx-5 lg:mx-2 h-8"},ia={__name:"PlannerWilderness",props:{settings:{type:Object,required:!0}},emits:{closeOverlay:{type:Function,required:!0},saveWildernessSettings:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,l=a,n=()=>{l("closeOverlay")},o=y(s.settings.dust1),m=y(s.settings.dust2),u=y(s.settings.dust3),c=y(s.settings.gold1),r=y(s.settings.gold2),i=y(s.settings.gold3),d=y(s.settings.vigor),b=y(s.settings.lazyModo),v=[0,1,2,3,4,5,6],x=[0,120,150,175,210,240,270],p=[0,60,75,80,96,108,120],$=(w,O)=>{switch(O){case"Dust 1":o.value=w;break;case"Dust 2":m.value=w;break;case"Dust 3":u.value=w;break;case"Gold 1":c.value=w;break;case"Gold 2":r.value=w;break;case"Gold 3":i.value=w;break}},k=()=>{const w=parseInt(d.value,10);if(isNaN(w)){d.value=null;return}if(w<0){d.value=0;return}if(w>50){d.value=50;return}d.value=w},M=()=>{const w={dust1:o.value,dust2:m.value,dust3:u.value,gold1:c.value,gold2:r.value,gold3:i.value,vigor:d.value,lazyModo:b.value,wildernessOutput:V.value};l("saveWildernessSettings",w),n()},V=R(()=>{const w=x[o.value]+x[m.value]+x[u.value],O=p[c.value]+p[r.value]+p[i.value],j=d.value?parseFloat(d.value/100):0,q=b.value?20:24,H=Math.ceil(w*(1+j)*q),F=Math.ceil(O*(1+j)*q);return{dust:H,gold:F}});return(w,O)=>(h(),g("div",Ps,[e("div",Bs,[e("button",{onClick:n,class:"absolute top-2 right-4 text-white"},Gs),Qs,e("div",Es,[S(N,{class:"select-list",options:v,selected:o.value,label:"Dust 1","onUpdate:selected":$},null,8,["selected"]),S(N,{class:"select-list",options:v,selected:m.value,label:"Dust 2","onUpdate:selected":$},null,8,["selected"]),S(N,{class:"select-list",options:v,selected:u.value,label:"Dust 3","onUpdate:selected":$},null,8,["selected"])]),Fs,e("div",Ts,[S(N,{class:"select-list",options:v,selected:c.value,label:"Gold 1","onUpdate:selected":$},null,8,["selected"]),S(N,{class:"select-list",options:v,selected:r.value,label:"Gold 2","onUpdate:selected":$},null,8,["selected"]),S(N,{class:"select-list",options:v,selected:i.value,label:"Gold 3","onUpdate:selected":$},null,8,["selected"])]),zs,e("div",Ks,[X(e("input",{onInput:k,"onUpdate:modelValue":O[0]||(O[0]=j=>d.value=j),type:"text",placeholder:"Vigor",class:"input input-bordered input-info input-sm mx-10 lg:mx-5 gradient-blue text-center"},null,544),[[ue,d.value]]),e("div",Hs,[e("div",Js,[e("label",Xs,[Ys,X(e("input",{"onUpdate:modelValue":O[1]||(O[1]=j=>b.value=j),type:"checkbox",checked:b.value,class:"checkbox checkbox-info"},null,8,Zs),[[$e,b.value]])])])])]),ea,e("div",ta,[e("div",sa,[e("label",aa,C(V.value.dust),1)]),e("div",la,[e("label",na,C(V.value.gold),1)])]),e("div",{class:"flex justify-center"},[e("button",{onClick:M,class:"btn btn-success"},"Save")])])]))}},oa=de(ia,[["__scopeId","data-v-ffb65882"]]),ra={class:"pb-6 z-50"},ca={class:"relative inline-block z-50"},ua=["src"],da=["src"],va={__name:"ItemWarehouse",props:{material:{type:Object,required:!0}},setup(t,{emit:a}){const s=t,l=a,n=y(s.material.Quantity),o=R(()=>ke(s.material)),m=()=>{const c=parseInt(n.value,10);if(isNaN(c)||c<0){n.value=0;return}n.value=c},u=()=>{m(),l("update:quantity",n.value)};return(c,r)=>(h(),g("div",ra,[e("div",ca,[e("img",{src:o.value.borderImagePath,alt:"Border Image",class:"w-20 h-20 absolute object-contain"},null,8,ua),e("img",{src:o.value.itemImagePath,alt:"Material Image",class:"w-20 h-20 object-contain"},null,8,da),X(e("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.value=i),onInput:u,type:"text",placeholder:"",class:"bg-slate-600 text-white absolute -bottom-3 left-3 w-14 input input-xs rounded-t-none text-center object-contain"},null,544),[[ue,n.value]])])]))}},ha={class:"list-overlay"},ma={class:"custom-modal-big h-5/6 lg:h-2/3 flex flex-col items-center"},ga=e("i",{class:"fas fa-times"},null,-1),fa=[ga],ya=e("p",{class:"text-white text-center font-bold text-lg"}," Warehouse ",-1),pa={class:"grid grid-cols-2 xl:grid-cols-4 justify-center items-center pb-5 text-center"},_a={class:"form-control items-center"},ba={class:"label cursor-pointer space-x-2"},xa=e("span",{class:"label-text text-error text-xs font-bold"},"Base Item",-1),$a={class:"form-control items-center"},Aa={class:"label cursor-pointer space-x-2"},ka=e("span",{class:"label-text text-info text-xs font-bold"},"Build Material",-1),wa={class:"form-control items-center"},Ia={class:"label cursor-pointer space-x-2"},Ca=e("span",{class:"label-text text-success text-xs font-bold"},"Insight Material",-1),Sa={class:"form-control items-center"},Ra={class:"label cursor-pointer space-x-2"},Ma=e("span",{class:"label-text text-warning text-xs font-bold"},"Resonate Material",-1),Oa={class:"custom-scrollbar overflow-y-scroll overflow-x-hidden flex-grow"},Na={class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-8"},La={__name:"PlannerWarehouse",emits:{closeOverlay:{type:Function,required:!0}},setup(t,{emit:a}){const s=a,l=y({"Base Item":!1,"Build Material":!1,"Insight Material":!1,"Resonate Material":!1});pe(()=>{E().data.length===0&&(console.log("Setting up warehouse"),U().items.data.forEach(c=>{c.IsReleased==!0&&(c.Category==="Build Material"||c.Category==="Insight Material"||c.Category==="Resonate Material"||c.Name==="Dust"||c.Name==="Sharpodonty")&&E().addItem(c.Name,c.Category)})),Ie(E().data)});const n=(c,r)=>{E().updateItem(c,r)},o=c=>{l.value[c]=!l.value[c]},m=R(()=>Object.values(l.value).some(r=>r)?E().data.filter(r=>l.value[r.Category]):E().data),u=()=>{s("closeOverlay")};return(c,r)=>(h(),g("div",ha,[e("div",ma,[e("button",{onClick:u,class:"absolute top-2 right-4 text-white"},fa),ya,e("div",null,[e("div",pa,[e("div",_a,[e("label",ba,[xa,e("input",{type:"checkbox",onChange:r[0]||(r[0]=i=>o("Base Item")),class:"checkbox checkbox-error"},null,32)])]),e("div",$a,[e("label",Aa,[ka,e("input",{type:"checkbox",onChange:r[1]||(r[1]=i=>o("Build Material")),class:"checkbox checkbox-info"},null,32)])]),e("div",wa,[e("label",Ia,[Ca,e("input",{type:"checkbox",onChange:r[2]||(r[2]=i=>o("Insight Material")),class:"checkbox checkbox-success"},null,32)])]),e("div",Sa,[e("label",Ra,[Ma,e("input",{type:"checkbox",onChange:r[3]||(r[3]=i=>o("Resonate Material")),class:"checkbox checkbox-warning"},null,32)])])])]),e("div",Oa,[e("div",Na,[(h(!0),g(L,null,G(m.value,i=>(h(),D(va,{class:"",key:i.Material,material:i,"onUpdate:quantity":d=>n(i.Material,d)},null,8,["material","onUpdate:quantity"]))),128))])])])]))}},Va={class:"list-overlay"},Da={class:"custom-modal-small h-auto space-y-5"},ja=e("i",{class:"fas fa-times"},null,-1),Ua=[ja],qa={class:"form-control"},Pa={class:"cursor-pointer label justify-center space-x-5"},Ba=e("span",{class:"label-text text-white text-md"},"Show unreleased",-1),Wa={__name:"PlannerSettings",props:{settings:{type:Object,required:!0}},emits:{closeOverlay:{type:Function,required:!0},saveSettings:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,l=a,n=y(s.settings.showUnreleased),o=()=>{l("closeOverlay")},m=()=>{const u={showUnreleased:n.value};l("saveSettings",u),o()};return(u,c)=>(h(),g("div",Va,[e("div",Da,[e("button",{onClick:o,class:"absolute top-2 right-4 text-white"},Ua),e("div",qa,[e("label",Pa,[Ba,X(e("input",{"onUpdate:modelValue":c[0]||(c[0]=r=>n.value=r),type:"checkbox",class:"checkbox checkbox-info"},null,512),[[$e,n.value]])])]),e("div",{class:"flex justify-center"},[e("button",{onClick:m,class:"btn btn-success"},"Save")])])]))}},Ga={class:"responsive-spacer"},Qa=e("h2",{class:"text-2xl text-white font-bold mb-4 lg:mb-6"},"Planner",-1),Ea=e("i",{class:"fa-solid fa-wand-magic-sparkles"},null,-1),Fa=e("i",{class:"fa-solid fa-tree"},null,-1),Ta=[Fa],za=e("i",{class:"fa-solid fa-box-archive"},null,-1),Ka=[za],Ha=e("i",{class:"fa-solid fa-gear"},null,-1),Ja=[Ha],Xa=e("div",{class:"custom-line"},null,-1),Ya=e("div",{class:"custom-line"},null,-1),Za={key:0,class:"overlay"},el={key:1,class:"overlay"},tl={key:2,class:"overlay"},sl={key:3,class:"overlay"},al={key:4,class:"overlay"},il={__name:"PlannerView",setup(t){const a=Oe(),s=Ne(),l=U().arcanists.data,n=Le(),o=y([]),m=R(()=>a.selectedArcanists.map(A=>A.info.Id));_e(()=>{o.value=l.filter(A=>!m.value.includes(A.Id)&&(n.settings.showUnreleased?!0:A.IsReleased)),o.value.sort((A,oe)=>{const he=oe.Rarity-A.Rarity;return he!==0?he:A.Name.localeCompare(oe.Name)})});const u=y([]),c=y([]),r=y(!1),i=y(!1),d=y(!1),b=y(!1),v=y(!1),x=y(null),p=y(null),$=y(null),k=y(null),M=y(null),V=()=>{r.value=!0},w=()=>{r.value=!1},O=()=>{i.value=!0},j=A=>{u.value=A,O()},q=()=>{i.value=!1},H=()=>{d.value=!0},F=()=>{d.value=!1},ne=()=>{b.value=!0},ee=()=>{b.value=!1},ie=()=>{v.value=!0},J=()=>{v.value=!1},P=A=>{u.value={info:A,isVisible:!0,currentInsight:0,currentLevel:1,currentResonance:0,goalInsight:0,goalLevel:1,goalResonance:0},O()},_=A=>{a.selectedArcanists=A,q()},f=A=>{o.value=A},I=A=>{c.value=A},Q=A=>{s.settings=A},ve=A=>{n.settings=A};return T(x,w),T(p,q),T($,F),T(k,ee),T(M,J),(A,oe)=>(h(),g("div",Ga,[Qa,S(Xt,{selectedArcanists:B(a).selectedArcanists,onOpenEditOverlay:j},null,8,["selectedArcanists"]),e("div",{class:"flex justify-between items-center mb-2 mt-2"},[e("button",{onClick:V,class:"btn btn-ghost btn-sm custom-gradient-button"},[Ea,Y(" Add Arcanist")]),e("div",{class:"flex space-x-2"},[e("div",{class:"tooltip","data-tip":"Wilderness Settings"},[e("button",{onClick:H,class:"btn btn-ghost btn-sm custom-gradient-button"},Ta)]),e("div",{class:"tooltip","data-tip":"Manage Warehouse"},[e("button",{onClick:ne,class:"btn btn-ghost btn-sm custom-gradient-button"},Ka)]),e("button",{onClick:ie,class:"btn btn-ghost btn-sm custom-gradient-button"},Ja)])]),Xa,S(qs,{totalActivityAndDays:c.value,wildernessSettings:B(s).settings},null,8,["totalActivityAndDays","wildernessSettings"]),Ya,r.value?(h(),g("div",Za,[S(Te,{ref_key:"arcanistListRef",ref:x,arcanists:o.value,onCloseOverlay:w,onSelectArcanist:P},null,8,["arcanists"])])):W("",!0),i.value?(h(),g("div",el,[S(Gt,{ref_key:"plannerEditRef",ref:p,selectedArcanist:u.value,selectedArcanists:B(a).selectedArcanists,listArcanists:o.value,onCloseOverlay:q,onUpdateSelectedArcanists:_,onUpdateListArcanists:f},null,8,["selectedArcanist","selectedArcanists","listArcanists"])])):W("",!0),d.value?(h(),g("div",tl,[S(oa,{ref_key:"wildernessRef",ref:$,settings:B(s).settings,onCloseOverlay:F,onSaveWildernessSettings:Q},null,8,["settings"])])):W("",!0),b.value?(h(),g("div",sl,[S(La,{ref_key:"warehouseRef",ref:k,onCloseOverlay:ee},null,512)])):W("",!0),v.value?(h(),g("div",al,[S(Wa,{ref_key:"settingsRef",ref:M,settings:B(n).settings,onCloseOverlay:J,onSaveSettings:ve},null,8,["settings"])])):W("",!0),S(xs,{selectedArcanists:B(a).selectedArcanists,"onUpdate:totalActivityAndDays":I},null,8,["selectedArcanists"])]))}};export{il as default};
