import{o as F}from"./index-VLcJB6i_.js";import{h as ae,o as d,c as m,a as e,n as z,d as y,i as M,w as X,v as ue,F as V,r as G,e as R,t as C,u as U,j as D,k as pe,b as Y,f as W,l as ge,_ as de,m as Ne,p as _e,q as B,s as be,x as xe,y as $e}from"./index-tYmkFctS.js";const Le=ae("planner",{state:()=>({selectedArcanists:[]}),persist:!0}),Ve=ae("wilderness",{state:()=>({settings:{dust1:6,dust2:6,dust3:6,gold1:6,gold2:6,gold3:6,vigor:0,lazyModo:!1,wildernessOutput:{dust:19440,gold:8640}}}),persist:!0}),je=ae("plannerSettings",{state:()=>({settings:{showUnreleased:!1}}),persist:!0}),De=["data-tip"],Ue={class:"rounded-md overflow-hidden"},qe={class:"avatar"},Pe=["src","alt"],Ae={__name:"ArcanistIcon",props:{arcanist:{type:Object,required:!0}},setup(t){const a=s=>`images/arcanists/icon/${s}.png`;return(s,n)=>(d(),m("div",{class:"tooltip","data-tip":t.arcanist.Name},[e("div",Ue,[e("div",qe,[e("div",{class:z(["w-10 rounded",{"bg-orange-300":t.arcanist.Rarity===6,"bg-yellow-100":t.arcanist.Rarity===5,"bg-purple-400":t.arcanist.Rarity===4,"bg-sky-200":t.arcanist.Rarity===3,"bg-green-200":t.arcanist.Rarity===2}])},[e("img",{src:a(t.arcanist.Id),alt:t.arcanist.Name},null,8,Pe)],2)])])],8,De))}},Qe={class:"list-overlay"},Be={class:"custom-modal-small h-2/3"},We={class:"relative mb-4"},Ge=e("i",{class:"fas fa-times"},null,-1),Ee=[Ge],Te={class:"p-2 overflow-y-auto h-5/6"},Fe=["onClick"],ze={class:"text-white ml-8"},Ke={__name:"ArcanistList",props:{arcanists:{type:Array,required:!0}},emits:{closeOverlay:{type:Function,required:!0},selectArcanist:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,i=v=>{n("selectArcanist",v),o()},o=()=>{n("closeOverlay")},h=y(""),c=M(()=>s.arcanists.filter(v=>v.Name.toLowerCase().includes(h.value.toLowerCase())));return(v,g)=>(d(),m("div",Qe,[e("div",Be,[e("div",We,[X(e("input",{"onUpdate:modelValue":g[0]||(g[0]=l=>h.value=l),type:"text",placeholder:"Search Arcanists",class:"bg-gray-800 text-white p-2 rounded-md w-11/12 focus:outline-none"},null,512),[[ue,h.value]]),e("button",{onClick:o,class:"absolute top-2 right-0 text-white"},Ee)]),e("div",Te,[(d(!0),m(V,null,G(c.value,l=>(d(),m("div",{key:l.Id,onClick:r=>i(l),class:"p-4 flex items-center cursor-pointer hover:bg-gray-700 transition-colors"},[R(Ae,{arcanist:l},null,8,["arcanist"]),e("span",ze,C(l.Name),1)],8,Fe))),128))])])]))}},me=U().items.data;function re(t){return t>1e6?`${(t/1e6).toFixed(1)}m`:t>1e4?`${(t/1e3).toFixed(0)}k`:t.toString()}function ke(t){const a=h=>{const c=me.find(v=>v.Name==h);return c?c.Id:null},s=h=>{const c=me.find(v=>v.Name==h);return c?c.Rarity:null},n=h=>{const c=a(h);return c?`images/items/icon/${c}.png`:null},i=h=>{const c=s(h);return c?`images/items/border/${c}.png`:null};return{material:t.Material,quantity:re(t.Quantity),itemImagePath:n(t.Material),borderImagePath:i(t.Material)}}const He=["data-tip"],Je={class:"relative inline-block"},Xe=["src"],Ye=["src"],Ze={class:"absolute text-white bottom-4 right-3 bg-gray-700 rounded-tl px-1 py-px text-xs"},we={__name:"ItemIcon",props:{material:{type:Object,required:!0}},setup(t){const a=t,s=M(()=>ke(a.material));return(n,i)=>(d(),m("div",{class:"tooltip","data-tip":s.value.material},[e("div",Je,[e("img",{src:s.value.borderImagePath,alt:"Border Image",class:"w-20 h-20 absolute object-contain"},null,8,Xe),e("img",{src:s.value.itemImagePath,alt:"Material Image",class:"w-20 h-20 object-contain"},null,8,Ye),e("div",Ze,C(s.value.quantity),1)])],8,He))}},et={class:"custom-scrollbar pt-10 flex flex-wrap justify-center overflow-y-scroll overflow-x-hidden"},tt={__name:"ItemList",props:{materialList:{type:Array,required:!0}},setup(t){const a=t;return(s,n)=>(d(),m("div",et,[(d(!0),m(V,null,G(a.materialList,i=>(d(),D(we,{key:i,material:i},null,8,["material"]))),128))]))}},st=U().calculations.data,fe=U().items.data;function Ie(t){t.sort((a,s)=>{const n=fe.find(v=>v.Name===a.Material),i=fe.find(v=>v.Name===s.Material),o=["Base Item","Resonate Material","Insight Material","Build Material"],h=o.indexOf(n.Category),c=o.indexOf(i.Category);return h!==c?h-c:i.Rarity!==n.Rarity?i.Rarity-n.Rarity:n.Name.localeCompare(i.Name)})}function Ce(t){const a={};return t.forEach(n=>{n&&(Array.isArray(n)?n.flat().forEach(({Material:o,Quantity:h})=>{a[o]?a[o]+=h:a[o]=h}):typeof n=="object"&&Object.entries(n).forEach(([i,o])=>{a[i]?a[i]+=o:a[i]=o}))}),Object.keys(a).map(n=>({Material:n,Quantity:a[n]}))}function at(t){var n,i;Ie(t);const a=((n=t.find(o=>o.Material==="Dust"))==null?void 0:n.Quantity)||0,s=((i=t.find(o=>o.Material==="Sharpodonty"))==null?void 0:i.Quantity)||0;return a===0&&s===0?t.filter(h=>h.Material!=="Dust"&&h.Material!=="Sharpodonty"):t}function Se(t){const a=l=>{let r={Dust:0,Sharpodonty:0};if(l.currentInsight==l.goalInsight){const{Dust:u,Sharpodonty:x}=i(l.currentLevel,l.goalLevel,l,l.currentInsight);return r.Dust+=u,r.Sharpodonty+=x,r}for(let u=l.currentInsight;u<=l.goalInsight;u++)if(u<l.goalInsight){const x=n(l,u);if(r.Dust+=x.Total.Dust,r.Sharpodonty+=x.Total.Sharpodonty,u==l.currentInsight){const{Dust:_,Sharpodonty:$}=i(1,l.currentLevel,l,u);r.Dust-=_,r.Sharpodonty-=$}}else{const{Dust:x,Sharpodonty:_}=i(1,l.goalLevel,l,u);r.Dust+=x,r.Sharpodonty+=_}return[{Material:"Dust",Quantity:r.Dust},{Material:"Sharpodonty",Quantity:r.Sharpodonty}]},s=(l,r,p)=>{const u={};if(l===r)return null;for(let _=Number(l+1);_<=r;_++){const $=p.find(I=>I.Id===_);$&&$.Material.forEach((I,S)=>{const j=$.Quantity[S];u[I]?u[I]+=j:u[I]=j})}return Object.keys(u).map(_=>({Material:_,Quantity:u[_]}))},n=(l,r)=>st.find(u=>u.Rarity.includes(l.info.Rarity)&&u.Insight==r),i=(l,r,p,u)=>{let x={Dust:0,Sharpodonty:0};for(let _=Number(++l);_<=Number(r);_++){const $=n(p,u),I=_.toString(),S=$.Levels[I];S&&(x.Dust+=S.Dust,x.Sharpodonty+=S.Sharpodonty)}return x},o=s(t.currentInsight,t.goalInsight,t.info.Insight),h=s(t.currentResonance,t.goalResonance,t.info.Resonance),c=a(t),v=Ce([o,h,c]);return at(v)}const lt={__name:"ArcanistCalculate",props:{arcanist:{type:Object,required:!0}},setup(t){const a=t,s=M(()=>{const n=a.arcanist;return Se(n)});return(n,i)=>(d(),m("div",null,[R(tt,{class:"max-h-48",materialList:s.value},null,8,["materialList"])]))}},nt={class:"relative w-2/3 md:w-1/3 flex justify-center"},it={key:0},ot=e("i",{class:"fa-regular fa-circle text-white"},null,-1),rt=[ot],ct={key:1},ut=["src","alt"],dt=e("div",{class:"flex items-center justify-center"},[e("i",{class:"fa-solid fa-caret-up text-blue-500"})],-1),vt={class:"grid grid-cols-4 gap-1 p-3 border border-blue-300 rounded-md shadow-lg options-box custom-gradient-gray-blue"},ht=["onClick"],gt={class:"flex items-center justify-center font-semibold rounded-full w-8 h-8 leading-none flex-col bg-blue-500 text-white"},mt={key:0},ft=e("i",{class:"fa-regular fa-circle text-white"},null,-1),yt=[ft],pt={key:1},_t=["src","alt"],L={__name:"SelectList",props:{label:{type:String,required:!0},options:{type:Array,required:!0},selected:{type:Number}},emits:["update:selected"],setup(t,{emit:a}){const s=t,n=a,i=y(!1),o=y(s.selected),h=y(null),c=()=>{i.value=!0},v=()=>{i.value=!1},g=r=>{o.value=r,n("update:selected",r,s.label),i.value=!1},l=r=>`images/items/common/insight${r}.png`;return F(h,v),pe(()=>{s.selected===void 0?(o.value=s.options[0],n("update:selected",s.options[0],s.label)):(o.value=s.selected,n("update:selected",s.selected,s.label))}),(r,p)=>(d(),m("div",nt,[e("button",{onClick:c,class:"btn btn-sm btn-ghost gradient-blue w-1/2 m-2"},[t.label==="Current Insight"||t.label==="Goal Insight"?(d(),m(V,{key:0},[o.value===0?(d(),m("div",it,rt)):(d(),m("div",ct,[e("img",{class:"avatar w-6",src:l(o.value),alt:"Option "+o.value},null,8,ut)]))],64)):(d(),m(V,{key:1},[Y(C(o.value),1)],64))]),i.value?(d(),m("div",{key:0,ref_key:"containerRef",ref:h,class:"absolute mt-14 w-48 lg:w-64 z-50"},[dt,e("div",vt,[(d(!0),m(V,null,G(t.options,u=>(d(),m("button",{key:u,class:"m-1",onClick:x=>g(u)},[e("div",gt,[t.label==="Current Insight"||t.label==="Goal Insight"?(d(),m(V,{key:0},[u===0?(d(),m("div",mt,yt)):(d(),m("div",pt,[e("img",{src:l(u),alt:"Option "+u},null,8,_t)]))],64)):(d(),m(V,{key:1},[Y(C(u),1)],64))])],8,ht))),128))])],512)):W("",!0)]))}},bt={class:"edit-overlay"},xt={class:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-gray-800 to-blue-950 p-4 border-2 border-black rounded-md w-11/12 sm:max-w-2xl lg:h-auto"},$t={class:"flex items-center p-2 mb-3 shadow-border-b"},At={class:"flex items-center justify-center mr-2 space-x-3"},kt={class:"text-1xl md:text-2xl text-white font-bold"},wt={class:"text-sm text-white",for:"raritySelect"},It={class:"ml-auto flex items-center space-x-3"},Ct={class:"tooltip","data-tip":"Hidden / Show"},St=e("i",{class:"fas fa-times"},null,-1),Rt=[St],Mt=e("div",{class:"custom-line"},null,-1),Ot=e("div",{class:"custom-label text-blue-100"},"Current Level",-1),Nt={class:"mt-2 flex justify-center items-center leading-none"},Lt=e("i",{class:"text-white text-center flex items-center justify-center font-extrabold text-2xl -translate-y-2"},"_",-1),Vt=e("div",{class:"custom-label text-blue-100"},"Goal Level",-1),jt={class:"mt-2 flex justify-center items-center leading-none"},Dt=e("i",{class:"text-white text-center flex items-center justify-center font-extrabold text-2xl -translate-y-2"},"_",-1),Ut=e("div",{class:"custom-label text-blue-100"},"Resonance",-1),qt={class:"mt-2 flex justify-center items-center leading-none"},Pt=e("i",{class:"text-white fa-solid fa-angles-right text-center"},null,-1),Qt={class:"flex justify-center space-x-4"},Bt={key:0,class:"toast toast-middle toast-center"},Wt=e("div",{class:"-translate-x-3 alert alert-info bg-red-300"},[e("span",null,"Current and Goal are the same!")],-1),Gt=[Wt],Et={__name:"PlannerEdit",props:{selectedArcanist:{type:Object,required:!0},selectedArcanists:{type:Array,required:!0},listArcanists:{type:Array,required:!0}},emits:{closeOverlay:{type:Function,required:!0},updateSelectedArcanists:{type:Function,required:!0},updateListArcanists:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,i=y(!1),o=y(0),h=U().calculations.data,c=y(s.selectedArcanist.info),v=y(s.selectedArcanists),g=y(s.listArcanists),l=y(s.selectedArcanist.currentInsight),r=y(s.selectedArcanist.currentLevel),p=y(s.selectedArcanist.currentResonance),u=y(s.selectedArcanist.goalInsight),x=y(s.selectedArcanist.goalLevel),_=y(s.selectedArcanist.goalResonance),$=y(s.selectedArcanist.isVisible),I=M(()=>({info:c.value,isVisible:$.value,currentInsight:l.value,currentLevel:r.value,goalInsight:u.value,goalLevel:x.value,currentResonance:p.value,goalResonance:_.value})),S=M(()=>c.value.Rarity),j=M(()=>[0,...c.value.Insight.map(b=>b.Id)]),k=M(()=>j.value.filter(b=>b>=l.value)),O=M(()=>{const b=h.find(f=>f.Rarity.includes(c.value.Rarity)&&f.Insight==l.value);return b?[1,...Object.keys(b.Levels).map(Number).filter(f=>f%5===0)]:[]}),N=M(()=>{if(u.value===null)return[];const b=h.find(f=>f.Rarity.includes(c.value.Rarity)&&f.Insight==u.value);return b?u.value===l.value?[1,...Object.keys(b.Levels).map(Number).filter(f=>f%5===0)].filter(f=>f>=r.value):[1,...Object.keys(b.Levels).map(Number).filter(f=>f%5===0)]:[]}),q=M(()=>{if(l.value===null)return[];if(l.value===0)return p.value=0,[0];const b=Number(l.value);if(b===0)return p.value=null,null;const f=b*5;return Array.from({length:f},(w,E)=>Number(E+1))}),H=M(()=>{if(u.value===null)return[];if(u.value===0)return _.value=0,[0];const b=Number(u.value),f=Number(p.value);if(b===0)return _.value=null,null;const w=f||1,E=b*5;return Array.from({length:E-w+1},(ve,A)=>Number(w+A))}),T=(b,f,w,E)=>Number(b)>Number(w)?!0:Number(b)<Number(w)?!1:Number(f)>Number(E),ne=()=>{if(l.value===u.value&&r.value===x.value&&p.value===_.value)return i.value=!0,setTimeout(()=>{i.value=!1},1e3),!0;i.value=!1},ee=()=>{if(ne())return;const b=v.value.findIndex(f=>Number(f.info.Id)===Number(I.value.info.Id));b!==-1?v.value[b]={...v.value[b],...I.value}:v.value.push(I.value),g.value=g.value.filter(f=>f.Id!==I.value.info.Id),n("updateSelectedArcanists",v.value),n("updateListArcanists",g.value),n("closeOverlay")},ie=()=>{const b=v.value.findIndex(f=>Number(f.info.Id)===Number(I.value.info.Id));b!==-1&&v.value.splice(b,1),J()},J=()=>{n("closeOverlay")},P=(b,f)=>{switch(f){case"Current Insight":l.value=b;break;case"Current Level":r.value=b;break;case"Current Resonance":p.value=b;break;case"Goal Insight":u.value=b;break;case"Goal Level":x.value=b;break;case"Goal Resonance":_.value=b;break;case"Visible":$.value=b;break}};return ge([l,r,p,u,x,_],()=>{o.value+=1,r.value>O.value[O.value.length-1]&&(r.value=O.value[O.value.length-1]),x.value>N.value[N.value.length-1]&&(x.value=N.value[N.value.length-1])}),ge([l,r,p],()=>{T(l.value,r.value,u.value,x.value)&&(u.value=l.value,x.value=r.value),Number(p.value)>Number(_.value)&&(_.value=p.value)}),(b,f)=>(d(),m("div",bt,[e("div",xt,[e("div",$t,[e("div",At,[R(Ae,{class:"ml-2",arcanist:c.value},null,8,["arcanist"]),e("h2",kt,C(c.value.Name),1),e("label",wt,[Y(C(S.value)+" ",1),e("i",{class:z(["fa-solid fa-star",{"text-orange-300":S.value===6,"text-yellow-100":S.value===5,"text-purple-400":S.value===4,"text-sky-200":S.value===3,"text-green-200":S.value===2}])},null,2)]),e("div",{class:"tooltip","data-tip":"Remove Arcanist"},[e("i",{onClick:ie,class:"fas fa-trash-alt text-gray-500"})])]),e("div",It,[e("div",Ct,[e("div",{onClick:f[0]||(f[0]=w=>$.value=!$.value),class:z(["badge badge-ghost",$.value?"green-badge":"red-badge"])},[e("i",{class:z($.value?"fa-regular fa-eye":"fa-regular fa-eye-slash")},null,2)],2)]),e("button",{onClick:J,class:"text-white"},Rt)])]),Mt,Ot,e("div",Nt,[(d(),D(L,{key:o.value,modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=w=>l.value=w),selected:l.value,label:"Current Insight",options:j.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"])),Lt,(d(),D(L,{key:o.value,modelValue:r.value,"onUpdate:modelValue":f[2]||(f[2]=w=>r.value=w),selected:r.value,label:"Current Level",options:O.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"]))]),Vt,e("div",jt,[(d(),D(L,{key:o.value,modelValue:u.value,"onUpdate:modelValue":f[3]||(f[3]=w=>u.value=w),selected:u.value,label:"Goal Insight",options:k.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"])),Dt,(d(),D(L,{key:o.value,modelValue:x.value,"onUpdate:modelValue":f[4]||(f[4]=w=>x.value=w),selected:x.value,label:"Goal Level",options:N.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"]))]),Ut,e("div",qt,[(d(),D(L,{key:o.value,modelValue:p.value,"onUpdate:modelValue":f[5]||(f[5]=w=>p.value=w),selected:p.value,label:"Current Resonance",options:q.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"])),Pt,(d(),D(L,{key:o.value,modelValue:_.value,"onUpdate:modelValue":f[6]||(f[6]=w=>_.value=w),selected:_.value,label:"Goal Resonance",options:H.value,"onUpdate:selected":P},null,8,["modelValue","selected","options"]))]),e("div",Qt,[e("button",{onClick:ee,class:"btn btn-success"},"Save"),i.value?(d(),m("div",Bt,Gt)):W("",!0)]),R(lt,{arcanist:I.value},null,8,["arcanist"])])]))}},Tt=["data-tip"],Ft={class:"rounded-md overflow-hidden"},zt={class:"avatar"},Kt=["src","alt"],Ht={__name:"ArcanistIconToggle",props:{arcanist:{type:Object,required:!0},visible:{type:Boolean,required:!0}},setup(t){const a=s=>`images/arcanists/icon/${s}.png`;return(s,n)=>(d(),m("div",{class:"tooltip","data-tip":t.arcanist.Name},[e("div",Ft,[e("div",zt,[e("div",{class:z(["w-12 rounded",{"filter-grayscale opacity-50":!t.visible,"bg-orange-300":t.arcanist.Rarity===6,"bg-yellow-100":t.arcanist.Rarity===5,"bg-purple-400":t.arcanist.Rarity===4,"bg-sky-200":t.arcanist.Rarity===3,"bg-green-200":t.arcanist.Rarity===2}])},[e("img",{src:a(t.arcanist.Id),alt:t.arcanist.Name},null,8,Kt)],2)])])],8,Tt))}},Jt=de(Ht,[["__scopeId","data-v-11642327"]]),Xt={class:"flex flex-row flex-wrap justify-center space-x-2"},Yt=e("p",{class:"text-center text-slate-700 text-sm opacity-80"},"Left click to edit, right click to show / hide.",-1),Zt={__name:"PlannerSelector",props:{selectedArcanists:{type:Array,required:!0}},emits:["open-edit-overlay"],setup(t,{emit:a}){const s=t,n=a,i=y(s.selectedArcanists),o=c=>{n("open-edit-overlay",c)},h=c=>{c.isVisible=!c.isVisible};return(c,v)=>(d(),m("div",null,[e("div",Xt,[(d(!0),m(V,null,G(i.value,g=>(d(),D(Jt,{key:g.Name,arcanist:g.info,visible:g.isVisible,onClick:l=>o(g),onContextmenu:Ne(l=>h(g),["prevent"])},null,8,["arcanist","visible","onClick","onContextmenu"]))),128))]),Yt]))}},Q=ae("warehouse",{state:()=>({isActive:!1,data:[],loaded:!1}),actions:{toggle(){this.isActive=!this.isActive},setData(t){this.data=t},setLoaded(){this.loaded=!0},addItem(t,a){this.data.push({Material:t,Quantity:0,Category:a})},updateItem(t,a){for(let s=0;s<this.data.length;s++)if(this.data[s].Material===t){this.data[s].Quantity=a;break}},resetAll(){for(let t=0;t<this.data.length;t++)this.data[t].Quantity=0},resetCategory(t){for(let a=0;a<this.data.length;a++)this.data[a].Category===t&&(this.data[a].Quantity=0)}},persist:!0}),Z=U().items.data,ce=U().stages.data,Re=U().crafts.data,Me=Q().data;function es(t){const a=t.map(s=>({...s}));return a.forEach(s=>{const n=Me.find(i=>i.Material===s.Material);n&&(s.Quantity-=n.Quantity)}),a}function ts(t){const a=t.map(s=>({...s}));return a.forEach(s=>{const n=Re.find(i=>i.Name===s.Material&&i.Rarity>=5)&&Me.find(i=>i.Material===s.Material);n&&(s.Quantity-=n.Quantity)}),a}function ss(t){let a=t.map(n=>({...n}));const s=[];return a.forEach(n=>{const i=Re.find(o=>o.Name===n.Material);if(i){s.push(i);for(let o=0;o<i.Material.length;o++){const h=i.Material[o],c=i.Quantity[o]*n.Quantity;c>0&&(a.find(v=>v.Material===h)?a.find(v=>v.Material===h).Quantity+=c:a.push({Material:h,Quantity:c}))}}}),a=a.filter(n=>!s.some(i=>i.Name===n.Material)),a.sort((n,i)=>{const o=Z.find(c=>c.Name===n.Material);return Z.find(c=>c.Name===i.Material).Id-o.Id}),a}function as(t){const s=Z.find(i=>i.Name===t.Material).Rarity,n=t.Quantity;return s===3?n*40:s===4?n*100:s===5?n*250:s===6?n*1500:0}function ls(t){return t==="Oneiric Shop"?"images/items/common/1.png":"images/items/common/0.png"}function Oe(t,a,s,n,i){return{stage:t,runs:isNaN(a)?0:a,activity:isNaN(s)?0:s,days:isNaN(n)?0:n,materials:i,activityImagePath:ls(t)}}function te(t,a){let s=a.find(n=>n.stage===t);return s||(s=Oe(t,null,t==="Oneiric Shop"?0:null,null,[]),a.push(s)),s}function se(t){return t.sort((a,s)=>{const n=ce.find(o=>o.Name===a.stage),i=ce.find(o=>o.Name===s.stage);return n&&i?n.Id-i.Id:n?-1:i?1:0})}function ye(t){const a=[],s=ts(t),n=ss(s);es(n).forEach(l=>{if(l.Quantity<=0)return;const r=ce.find(p=>p.Material.includes(l.Material));if(r){const p=Math.ceil(parseFloat(l.Quantity)/parseFloat(r.Quantity)),u=Math.ceil(p*r.Activity),x=(u/240).toFixed(1);if(l.Quantity>0){const _=a.findIndex($=>$.stage===r.Name);_!==-1?a[_].materials.push(l):a.push(Oe(r.Name,p,u,x,[l]))}}else{const p=te("Tier 3",a),u=te("Tier 2",a),x=te("Oneiric Shop",a),_=te("Unreleased",a);if(Z.find($=>$.Name===l.Material).Category==="Resonate Material")x.activity+=as(l),x.materials.push(l);else{const $=Z.find(S=>S.Name===l.Material).Rarity;($===3?p:$===2?u:_).materials.push(l)}}});const o=a.filter(l=>["The Poussiere VI","Mintage Aesthetics VI","Oneiric Shop"].includes(l.stage)&&l.materials.length>0),h=a.filter(l=>(l.stage.endsWith("II")||l.stage.endsWith("IV")||l.stage.endsWith("VI"))&&!o.some(r=>r.stage===l.stage)&&l.materials.length>0),c=a.filter(l=>!["Tier 2","Tier 3","Unreleased",...o.map(r=>r.stage),...h.map(r=>r.stage)].includes(l.stage)&&l.materials.length>0),v=a.filter(l=>["Tier 2","Tier 3","Unreleased"].includes(l.stage)&&l.materials.length>0);return[{id:0,cards:se(o)},{id:1,cards:se(h)},{id:2,cards:se(c)},{id:3,cards:se(v)}]}function ns(t){let a=0,s=0;return t.forEach(n=>{n.cards.forEach(i=>{i.days!==null&&(a+=i.activity,s+=parseFloat(i.days))})}),[a,s.toFixed(0)]}const is={class:"bg-gray-700/40 shadow rounded flex flex-col items-center justify-between relative"},os={class:"stage text-white p-2"},rs={class:"calculations w-full flex justify-center items-center bg-gradient-to-r from-blue-800/70 to-blue-900/90 text-white p-2 rounded-md"},cs={class:"border-blue-700/90 border-r pr-3"},us={key:0},ds=e("i",{class:"fa-solid fa-xmark text-xs mr-0.5"},null,-1),vs={key:1},hs={class:"pl-2"},gs=["src"],ms={class:"border-blue-700/90 border-l pl-3"},fs={class:"items-center flex"},ys={__name:"Card",props:{card:{type:Object,required:!0}},setup(t){return(a,s)=>(d(),m("div",is,[e("div",os,[e("p",null,C(t.card.stage),1)]),e("div",rs,[e("p",cs,[t.card.runs>0?(d(),m("span",us,[ds,Y(C(t.card.runs),1)])):(d(),m("span",vs,C(t.card.runs),1))]),e("p",hs,C(t.card.activity==null?"?":t.card.activity),1),e("img",{src:t.card.activityImagePath,alt:"Activity Image",class:"inline-block w-8 h-8"},null,8,gs),e("p",ms,C(t.card.days)+" "+C(t.card.days===null?"":t.card.days>1?"days":"day"),1)]),e("div",fs,[(d(!0),m(V,null,G(t.card.materials,(n,i)=>(d(),m("div",{key:i},[R(we,{material:n},null,8,["material"])]))),128))])]))}},ps={class:"w-full mb-4 flex flex-col"},_s={class:"mb-4 gap-3 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4"},bs={__name:"PlannerLayer",props:{layer:{type:Object,required:!0}},setup(t){const a=t,s=M(()=>a.layer.cards&&a.layer.cards.length>0),n=M(()=>{switch(a.layer.id){case 0:return"yellow-badge";case 1:return"indigo-badge";case 2:return"purple-badge";case 3:return"green-badge";default:return"red-badge"}}),i=M(()=>{switch(a.layer.id){case 0:return"Resources";case 1:return"Insight";case 2:return"Hard Stages";case 3:return"Miscs";default:return"Undefined"}});return(o,h)=>(d(),m("div",ps,[s.value?(d(),m("div",{key:0,class:z(["badge badge-lg badge-ghost mt-2 mb-2 w-32",n.value])},C(i.value),3)):W("",!0),e("div",_s,[(d(!0),m(V,null,G(t.layer.cards,(c,v)=>(d(),D(ys,{key:v,card:c},null,8,["card"]))),128))])]))}},xs={class:"flex flex-wrap"},$s={__name:"PlannerResult",props:{selectedArcanists:{type:Array,required:!0}},emits:["update:totalActivityAndDays"],setup(t,{emit:a}){const s=t,n=a,i=y([]),o=y([]);return _e(()=>{const h=s.selectedArcanists.map(v=>v.isVisible?Se(v):[]),c=Ce(h);i.value=c,n("update:totalActivityAndDays",ns(ye(c))),o.value=ye(c)}),(h,c)=>(d(),m("div",xs,[(d(!0),m(V,null,G(o.value,(v,g)=>(d(),D(bs,{key:g,layer:v},null,8,["layer"]))),128))]))}},As="/Kornblume/images/items/common/0.png",ks="/Kornblume/images/items/icon/55.png",ws="/Kornblume/images/items/icon/54.png",le=t=>(be("data-v-b116625d"),t=t(),xe(),t),Is={class:"flex custom-gradient-gray-blue-light px-2 py-2 md:px-4 lg:px-6 rounded-md items-center justify-center"},Cs=le(()=>e("i",{class:"fa-solid fa-calculator text-white mr-3"},null,-1)),Ss={class:"tooltip flex items-center","data-tip":"Calculations hasn't been optimized"},Rs={class:"text"},Ms=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:As,alt:"avatar"})])],-1)),Os={class:"text pr-3"},Ns={class:"tooltip","data-tip":"Wilderness Production"},Ls={class:"text"},Vs=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:ks,alt:"avatar"})])],-1)),js={class:"tooltip","data-tip":"Wilderness Production"},Ds={class:"text"},Us=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:ws,alt:"avatar"})])],-1)),qs={__name:"PlannerTotal",props:{totalActivityAndDays:{type:Array,required:!0},wildernessSettings:{type:Object,required:!0}},setup(t){return(a,s)=>(d(),m("div",Is,[Cs,e("div",Ss,[e("div",Rs,C(t.totalActivityAndDays[0]),1),Ms,e("div",Os,C(t.totalActivityAndDays[1])+" "+C(t.totalActivityAndDays[1]>1?"days":"day"),1)]),e("div",Ns,[e("div",Ls,C(B(re)(t.wildernessSettings.wildernessOutput.dust*t.totalActivityAndDays[1])),1)]),Vs,e("div",js,[e("div",Ds,C(B(re)(t.wildernessSettings.wildernessOutput.gold*t.totalActivityAndDays[1])),1)]),Us]))}},Ps=de(qs,[["__scopeId","data-v-b116625d"]]),K=t=>(be("data-v-9672159b"),t=t(),xe(),t),Qs={class:"list-overlay"},Bs={class:"custom-modal-small h-auto"},Ws=K(()=>e("i",{class:"fas fa-times"},null,-1)),Gs=[Ws],Es=K(()=>e("div",{class:"custom-label text-yellow-100"},"Dust Bell Towers",-1)),Ts={class:"grid grid-cols-3"},Fs=K(()=>e("div",{class:"custom-label text-yellow-100"},"Gold Bell Towers",-1)),zs={class:"grid grid-cols-3"},Ks=K(()=>e("div",{class:"custom-label text-yellow-100"},"Vigor (%)",-1)),Hs={class:"grid grid-cols-2 p-2 items-center"},Js={class:"tooltip","data-tip":"Collect once a day"},Xs={class:"form-control"},Ys={class:"cursor-pointer label justify-center"},Zs=K(()=>e("span",{class:"label-text text-yellow-100 mr-3"},"Lazy Modo",-1)),ea=["checked"],ta=K(()=>e("div",{class:"custom-label text-yellow-100"},"Output",-1)),sa={class:"grid grid-cols-2 p-2"},aa={class:"tooltip","data-tip":"Dust"},la={class:"flex items-center justify-center gradient-blue text-center rounded-xl mx-5 lg:mx-2 h-8"},na={class:"tooltip","data-tip":"Sharpodonty"},ia={class:"flex items-center justify-center gradient-blue text-center rounded-xl mx-5 lg:mx-2 h-8"},oa={__name:"PlannerWilderness",props:{settings:{type:Object,required:!0}},emits:{closeOverlay:{type:Function,required:!0},saveWildernessSettings:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,i=()=>{n("closeOverlay")},o=y(s.settings.dust1),h=y(s.settings.dust2),c=y(s.settings.dust3),v=y(s.settings.gold1),g=y(s.settings.gold2),l=y(s.settings.gold3),r=y(s.settings.vigor),p=y(s.settings.lazyModo),u=[0,1,2,3,4,5,6],x=[0,120,150,175,210,240,270],_=[0,60,75,80,96,108,120],$=(k,O)=>{switch(O){case"Dust 1":o.value=k;break;case"Dust 2":h.value=k;break;case"Dust 3":c.value=k;break;case"Gold 1":v.value=k;break;case"Gold 2":g.value=k;break;case"Gold 3":l.value=k;break}},I=()=>{const k=parseInt(r.value,10);if(isNaN(k)){r.value=null;return}if(k<0){r.value=0;return}if(k>50){r.value=50;return}r.value=k},S=()=>{const k={dust1:o.value,dust2:h.value,dust3:c.value,gold1:v.value,gold2:g.value,gold3:l.value,vigor:r.value,lazyModo:p.value,wildernessOutput:j.value};n("saveWildernessSettings",k),i()},j=M(()=>{const k=x[o.value]+x[h.value]+x[c.value],O=_[v.value]+_[g.value]+_[l.value],N=r.value?parseFloat(r.value/100):0,q=p.value?20:24,H=Math.ceil(k*(1+N)*q),T=Math.ceil(O*(1+N)*q);return{dust:H,gold:T}});return(k,O)=>(d(),m("div",Qs,[e("div",Bs,[e("button",{onClick:i,class:"absolute top-2 right-4 text-white"},Gs),Es,e("div",Ts,[R(L,{class:"select-list",options:u,selected:o.value,label:"Dust 1","onUpdate:selected":$},null,8,["selected"]),R(L,{class:"select-list",options:u,selected:h.value,label:"Dust 2","onUpdate:selected":$},null,8,["selected"]),R(L,{class:"select-list",options:u,selected:c.value,label:"Dust 3","onUpdate:selected":$},null,8,["selected"])]),Fs,e("div",zs,[R(L,{class:"select-list",options:u,selected:v.value,label:"Gold 1","onUpdate:selected":$},null,8,["selected"]),R(L,{class:"select-list",options:u,selected:g.value,label:"Gold 2","onUpdate:selected":$},null,8,["selected"]),R(L,{class:"select-list",options:u,selected:l.value,label:"Gold 3","onUpdate:selected":$},null,8,["selected"])]),Ks,e("div",Hs,[X(e("input",{onInput:I,"onUpdate:modelValue":O[0]||(O[0]=N=>r.value=N),type:"text",placeholder:"Vigor",class:"input input-bordered input-info input-sm mx-10 lg:mx-5 gradient-blue text-center"},null,544),[[ue,r.value]]),e("div",Js,[e("div",Xs,[e("label",Ys,[Zs,X(e("input",{"onUpdate:modelValue":O[1]||(O[1]=N=>p.value=N),type:"checkbox",checked:p.value,class:"checkbox checkbox-info"},null,8,ea),[[$e,p.value]])])])])]),ta,e("div",sa,[e("div",aa,[e("label",la,C(j.value.dust),1)]),e("div",na,[e("label",ia,C(j.value.gold),1)])]),e("div",{class:"flex justify-center"},[e("button",{onClick:S,class:"btn btn-success"},"Save")])])]))}},ra=de(oa,[["__scopeId","data-v-9672159b"]]),ca={class:"pb-6 z-50"},ua={class:"relative inline-block z-50"},da=["src"],va=["src"],ha={__name:"ItemWarehouse",props:{material:{type:Object,required:!0}},setup(t,{emit:a}){const s=t,n=a,i=y(s.material.Quantity),o=M(()=>ke(s.material)),h=()=>{const v=parseInt(i.value,10);if(isNaN(v)||v<0){i.value=0;return}i.value=v},c=()=>{h(),n("update:quantity",i.value)};return(v,g)=>(d(),m("div",ca,[e("div",ua,[e("img",{src:o.value.borderImagePath,alt:"Border Image",class:"w-20 h-20 absolute object-contain"},null,8,da),e("img",{src:o.value.itemImagePath,alt:"Material Image",class:"w-20 h-20 object-contain"},null,8,va),X(e("input",{"onUpdate:modelValue":g[0]||(g[0]=l=>i.value=l),onInput:c,type:"text",placeholder:"",class:"bg-slate-600 text-white absolute -bottom-3 left-3 w-14 input input-xs rounded-t-none text-center object-contain"},null,544),[[ue,i.value]])])]))}},ga={class:"list-overlay"},ma={class:"custom-modal-big h-5/6 lg:h-2/3 flex flex-col items-center"},fa=e("i",{class:"fas fa-times"},null,-1),ya=[fa],pa=e("p",{class:"text-white text-center font-bold text-lg"}," Warehouse ",-1),_a={class:"grid grid-cols-2 xl:grid-cols-4 justify-center items-center pb-5 text-center"},ba={class:"form-control items-center"},xa={class:"label cursor-pointer space-x-2"},$a=e("span",{class:"label-text text-error text-xs font-bold"},"Base Item",-1),Aa={class:"form-control items-center"},ka={class:"label cursor-pointer space-x-2"},wa=e("span",{class:"label-text text-info text-xs font-bold"},"Build Material",-1),Ia={class:"form-control items-center"},Ca={class:"label cursor-pointer space-x-2"},Sa=e("span",{class:"label-text text-success text-xs font-bold"},"Insight Material",-1),Ra={class:"form-control items-center"},Ma={class:"label cursor-pointer space-x-2"},Oa=e("span",{class:"label-text text-warning text-xs font-bold"},"Resonate Material",-1),Na={class:"custom-scrollbar overflow-y-scroll overflow-x-hidden flex-grow mb-5"},La={class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-8"},Va={__name:"PlannerWarehouse",emits:{closeOverlay:{type:Function,required:!0}},setup(t,{emit:a}){const s=a,n=y({"Base Item":!1,"Build Material":!1,"Insight Material":!1,"Resonate Material":!1});pe(()=>{Q().data.length===0&&(console.log("Setting up warehouse"),U().items.data.forEach(g=>{g.IsReleased==!0&&(g.Category==="Build Material"||g.Category==="Insight Material"||g.Category==="Resonate Material"||g.Name==="Dust"||g.Name==="Sharpodonty")&&Q().addItem(g.Name,g.Category)})),Ie(Q().data)});const i=(g,l)=>{Q().updateItem(g,l)},o=g=>{n.value[g]=!n.value[g]},h=M(()=>Object.values(n.value).some(l=>l)?Q().data.filter(l=>n.value[l.Category]):Q().data),c=()=>{Object.keys(n.value).forEach(g=>{n.value[g]&&Q().resetCategory(g)}),s("closeOverlay")},v=()=>{s("closeOverlay")};return(g,l)=>(d(),m("div",ga,[e("div",ma,[e("button",{onClick:v,class:"absolute top-2 right-4 text-white"},ya),pa,e("div",null,[e("div",_a,[e("div",ba,[e("label",xa,[$a,e("input",{type:"checkbox",onChange:l[0]||(l[0]=r=>o("Base Item")),class:"checkbox checkbox-error"},null,32)])]),e("div",Aa,[e("label",ka,[wa,e("input",{type:"checkbox",onChange:l[1]||(l[1]=r=>o("Build Material")),class:"checkbox checkbox-info"},null,32)])]),e("div",Ia,[e("label",Ca,[Sa,e("input",{type:"checkbox",onChange:l[2]||(l[2]=r=>o("Insight Material")),class:"checkbox checkbox-success"},null,32)])]),e("div",Ra,[e("label",Ma,[Oa,e("input",{type:"checkbox",onChange:l[3]||(l[3]=r=>o("Resonate Material")),class:"checkbox checkbox-warning"},null,32)])])])]),e("div",Na,[e("div",La,[(d(!0),m(V,null,G(h.value,r=>(d(),D(ha,{class:"",key:r.Material,material:r,"onUpdate:quantity":p=>i(r.Material,p)},null,8,["material","onUpdate:quantity"]))),128))])]),e("button",{onClick:c,className:"btn btn-error btn-sm"},"Reset Selected Category")])]))}},ja={class:"list-overlay"},Da={class:"custom-modal-small h-auto space-y-5"},Ua=e("i",{class:"fas fa-times"},null,-1),qa=[Ua],Pa={class:"form-control"},Qa={class:"cursor-pointer label justify-center space-x-5"},Ba=e("span",{class:"label-text text-white text-md"},"Show unreleased",-1),Wa={__name:"PlannerSettings",props:{settings:{type:Object,required:!0}},emits:{closeOverlay:{type:Function,required:!0},saveSettings:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,i=y(s.settings.showUnreleased),o=()=>{n("closeOverlay")},h=()=>{const c={showUnreleased:i.value};n("saveSettings",c),o()};return(c,v)=>(d(),m("div",ja,[e("div",Da,[e("button",{onClick:o,class:"absolute top-2 right-4 text-white"},qa),e("div",Pa,[e("label",Qa,[Ba,X(e("input",{"onUpdate:modelValue":v[0]||(v[0]=g=>i.value=g),type:"checkbox",class:"checkbox checkbox-info"},null,512),[[$e,i.value]])])]),e("div",{class:"flex justify-center"},[e("button",{onClick:h,class:"btn btn-success"},"Save")])])]))}},Ga={class:"responsive-spacer"},Ea=e("h2",{class:"text-2xl text-white font-bold mb-4 lg:mb-6"},"Planner",-1),Ta=e("i",{class:"fa-solid fa-wand-magic-sparkles"},null,-1),Fa=e("i",{class:"fa-solid fa-tree"},null,-1),za=[Fa],Ka=e("i",{class:"fa-solid fa-box-archive"},null,-1),Ha=[Ka],Ja=e("i",{class:"fa-solid fa-gear"},null,-1),Xa=[Ja],Ya=e("div",{class:"custom-line"},null,-1),Za=e("div",{class:"custom-line"},null,-1),el={key:0,class:"overlay"},tl={key:1,class:"overlay"},sl={key:2,class:"overlay"},al={key:3,class:"overlay"},ll={key:4,class:"overlay"},ol={__name:"PlannerView",setup(t){const a=Le(),s=Ve(),n=U().arcanists.data,i=je(),o=y([]),h=M(()=>a.selectedArcanists.map(A=>A.info.Id));_e(()=>{o.value=n.filter(A=>!h.value.includes(A.Id)&&(i.settings.showUnreleased?!0:A.IsReleased)),o.value.sort((A,oe)=>{const he=oe.Rarity-A.Rarity;return he!==0?he:A.Name.localeCompare(oe.Name)})});const c=y([]),v=y([]),g=y(!1),l=y(!1),r=y(!1),p=y(!1),u=y(!1),x=y(null),_=y(null),$=y(null),I=y(null),S=y(null),j=()=>{g.value=!0},k=()=>{g.value=!1},O=()=>{l.value=!0},N=A=>{c.value=A,O()},q=()=>{l.value=!1},H=()=>{r.value=!0},T=()=>{r.value=!1},ne=()=>{p.value=!0},ee=()=>{p.value=!1},ie=()=>{u.value=!0},J=()=>{u.value=!1},P=A=>{c.value={info:A,isVisible:!0,currentInsight:0,currentLevel:1,currentResonance:0,goalInsight:0,goalLevel:1,goalResonance:0},O()},b=A=>{a.selectedArcanists=A,q()},f=A=>{o.value=A},w=A=>{v.value=A},E=A=>{s.settings=A},ve=A=>{i.settings=A};return F(x,k),F(_,q),F($,T),F(I,ee),F(S,J),(A,oe)=>(d(),m("div",Ga,[Ea,R(Zt,{selectedArcanists:B(a).selectedArcanists,onOpenEditOverlay:N},null,8,["selectedArcanists"]),e("div",{class:"flex justify-between items-center mb-2 mt-2"},[e("button",{onClick:j,class:"btn btn-ghost btn-sm custom-gradient-button"},[Ta,Y(" Add Arcanist")]),e("div",{class:"flex space-x-2"},[e("div",{class:"tooltip","data-tip":"Wilderness Settings"},[e("button",{onClick:H,class:"btn btn-ghost btn-sm custom-gradient-button"},za)]),e("div",{class:"tooltip","data-tip":"Manage Warehouse"},[e("button",{onClick:ne,class:"btn btn-ghost btn-sm custom-gradient-button"},Ha)]),e("button",{onClick:ie,class:"btn btn-ghost btn-sm custom-gradient-button"},Xa)])]),Ya,R(Ps,{totalActivityAndDays:v.value,wildernessSettings:B(s).settings},null,8,["totalActivityAndDays","wildernessSettings"]),Za,g.value?(d(),m("div",el,[R(Ke,{ref_key:"arcanistListRef",ref:x,arcanists:o.value,onCloseOverlay:k,onSelectArcanist:P},null,8,["arcanists"])])):W("",!0),l.value?(d(),m("div",tl,[R(Et,{ref_key:"plannerEditRef",ref:_,selectedArcanist:c.value,selectedArcanists:B(a).selectedArcanists,listArcanists:o.value,onCloseOverlay:q,onUpdateSelectedArcanists:b,onUpdateListArcanists:f},null,8,["selectedArcanist","selectedArcanists","listArcanists"])])):W("",!0),r.value?(d(),m("div",sl,[R(ra,{ref_key:"wildernessRef",ref:$,settings:B(s).settings,onCloseOverlay:T,onSaveWildernessSettings:E},null,8,["settings"])])):W("",!0),p.value?(d(),m("div",al,[R(Va,{ref_key:"warehouseRef",ref:I,onCloseOverlay:ee},null,512)])):W("",!0),u.value?(d(),m("div",ll,[R(Wa,{ref_key:"settingsRef",ref:S,settings:B(i).settings,onCloseOverlay:J,onSaveSettings:ve},null,8,["settings"])])):W("",!0),R($s,{selectedArcanists:B(a).selectedArcanists,"onUpdate:totalActivityAndDays":w},null,8,["selectedArcanists"])]))}};export{ol as default};
