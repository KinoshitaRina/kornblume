import{o as F}from"./index-DNvTOTAy.js";import{h as ae,o as m,c as g,a as e,n as T,d as f,i as O,w as J,v as ue,F as L,r as W,e as C,t as S,u as q,j as V,k as pe,b as X,f as Q,l as he,_ as de,m as Oe,p as _e,q as U,s as be,x as xe,y as $e}from"./index-q8Ki6FyA.js";const Ne=ae("planner",{state:()=>({selectedArcanists:[]}),persist:!0}),Me=ae("wilderness",{state:()=>({settings:{dust1:6,dust2:6,dust3:6,gold1:6,gold2:6,gold3:6,vigor:0,lazyModo:!1,wildernessOutput:{dust:19440,gold:8640}}}),persist:!0}),Le=ae("plannerSettings",{state:()=>({settings:{showUnreleased:!1}}),persist:!0}),De=["data-tip"],Ve={class:"rounded-md overflow-hidden"},je={class:"avatar"},Ue=["src","alt"],Ae={__name:"ArcanistIcon",props:{arcanist:{type:Object,required:!0}},setup(t){const a=s=>`images/arcanists/icon/${s}.png`;return(s,n)=>(m(),g("div",{class:"tooltip","data-tip":t.arcanist.Name},[e("div",Ve,[e("div",je,[e("div",{class:T(["w-10 rounded",{"bg-orange-300":t.arcanist.Rarity===6,"bg-yellow-100":t.arcanist.Rarity===5,"bg-purple-400":t.arcanist.Rarity===4,"bg-sky-200":t.arcanist.Rarity===3,"bg-green-200":t.arcanist.Rarity===2}])},[e("img",{src:a(t.arcanist.Id),alt:t.arcanist.Name},null,8,Ue)],2)])])],8,De))}},qe={class:"list-overlay"},Pe={class:"custom-modal-small h-2/3"},Ge={class:"relative mb-4"},Qe=e("i",{class:"fas fa-times"},null,-1),We=[Qe],Be={class:"p-2 overflow-y-auto h-5/6"},Ee=["onClick"],Fe={class:"text-white ml-8"},Te={__name:"ArcanistList",props:{arcanists:{type:Array,required:!0}},emits:{closeOverlay:{type:Function,required:!0},selectArcanist:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,l=c=>{n("selectArcanist",c),i()},i=()=>{n("closeOverlay")},h=f(""),o=O(()=>s.arcanists.filter(c=>c.Name.toLowerCase().includes(h.value.toLowerCase())));return(c,v)=>(m(),g("div",qe,[e("div",Pe,[e("div",Ge,[J(e("input",{"onUpdate:modelValue":v[0]||(v[0]=r=>h.value=r),type:"text",placeholder:"Search Arcanists",class:"bg-gray-800 text-white p-2 rounded-md w-11/12 focus:outline-none"},null,512),[[ue,h.value]]),e("button",{onClick:i,class:"absolute top-2 right-0 text-white"},We)]),e("div",Be,[(m(!0),g(L,null,W(o.value,r=>(m(),g("div",{key:r.Id,onClick:u=>l(r),class:"p-4 flex items-center cursor-pointer hover:bg-gray-700 transition-colors"},[C(Ae,{arcanist:r},null,8,["arcanist"]),e("span",Fe,S(r.Name),1)],8,Ee))),128))])])]))}},ge=q().items.data;function oe(t){return t>1e6?`${(t/1e6).toFixed(1)}m`:t>1e4?`${(t/1e3).toFixed(0)}k`:t.toString()}function we(t){const a=h=>{const o=ge.find(c=>c.Name==h);return o?o.Id:null},s=h=>{const o=ge.find(c=>c.Name==h);return o?o.Rarity:null},n=h=>{const o=a(h);return o?`images/items/icon/${o}.png`:null},l=h=>{const o=s(h);return o?`images/items/border/${o}.png`:null};return{material:t.Material,quantity:oe(t.Quantity),itemImagePath:n(t.Material),borderImagePath:l(t.Material)}}const ze=["data-tip"],Ke={class:"relative inline-block"},He=["src"],Je=["src"],Xe={class:"absolute text-white bottom-4 right-3 bg-gray-700 rounded-tl px-1 py-px text-xs"},Ie={__name:"ItemIcon",props:{material:{type:Object,required:!0}},setup(t){const a=t,s=O(()=>we(a.material));return(n,l)=>(m(),g("div",{class:"tooltip","data-tip":s.value.material},[e("div",Ke,[e("img",{src:s.value.borderImagePath,alt:"Border Image",class:"w-20 h-20 absolute object-contain"},null,8,He),e("img",{src:s.value.itemImagePath,alt:"Material Image",class:"w-20 h-20 object-contain"},null,8,Je),e("div",Xe,S(s.value.quantity),1)])],8,ze))}},Ye={class:"custom-scrollbar pt-10 flex flex-wrap justify-center overflow-y-scroll overflow-x-hidden"},Ze={__name:"ItemList",props:{materialList:{type:Array,required:!0}},setup(t){const a=t;return(s,n)=>(m(),g("div",Ye,[(m(!0),g(L,null,W(a.materialList,l=>(m(),V(Ie,{key:l,material:l},null,8,["material"]))),128))]))}},et=q().calculations.data,fe=q().items.data;function ke(t){t.sort((a,s)=>{const n=fe.find(c=>c.Name===a.Material),l=fe.find(c=>c.Name===s.Material),i=["Base Item","Resonate Material","Insight Material","Build Material"],h=i.indexOf(n.Category),o=i.indexOf(l.Category);return h!==o?h-o:l.Rarity!==n.Rarity?l.Rarity-n.Rarity:n.Name.localeCompare(l.Name)})}function Se(t){const a={};return t.forEach(n=>{n&&(Array.isArray(n)?n.flat().forEach(({Material:i,Quantity:h})=>{a[i]?a[i]+=h:a[i]=h}):typeof n=="object"&&Object.entries(n).forEach(([l,i])=>{a[l]?a[l]+=i:a[l]=i}))}),Object.keys(a).map(n=>({Material:n,Quantity:a[n]}))}function tt(t){var n,l;ke(t);const a=((n=t.find(i=>i.Material==="Dust"))==null?void 0:n.Quantity)||0,s=((l=t.find(i=>i.Material==="Sharpodonty"))==null?void 0:l.Quantity)||0;return a===0&&s===0?t.filter(h=>h.Material!=="Dust"&&h.Material!=="Sharpodonty"):t}function Ce(t){const a=r=>{let u={Dust:0,Sharpodonty:0};if(r.currentInsight==r.goalInsight){const{Dust:d,Sharpodonty:x}=l(r.currentLevel,r.goalLevel,r,r.currentInsight);return u.Dust+=d,u.Sharpodonty+=x,u}for(let d=r.currentInsight;d<=r.goalInsight;d++)if(d<r.goalInsight){const x=n(r,d);if(u.Dust+=x.Total.Dust,u.Sharpodonty+=x.Total.Sharpodonty,d==r.currentInsight){const{Dust:p,Sharpodonty:$}=l(1,r.currentLevel,r,d);u.Dust-=p,u.Sharpodonty-=$}}else{const{Dust:x,Sharpodonty:p}=l(1,r.goalLevel,r,d);u.Dust+=x,u.Sharpodonty+=p}return[{Material:"Dust",Quantity:u.Dust},{Material:"Sharpodonty",Quantity:u.Sharpodonty}]},s=(r,u,b)=>{const d={};if(r===u)return null;for(let p=Number(r+1);p<=u;p++){const $=b.find(w=>w.Id===p);$&&$.Material.forEach((w,R)=>{const D=$.Quantity[R];d[w]?d[w]+=D:d[w]=D})}return Object.keys(d).map(p=>({Material:p,Quantity:d[p]}))},n=(r,u)=>et.find(d=>d.Rarity.includes(r.info.Rarity)&&d.Insight==u),l=(r,u,b,d)=>{let x={Dust:0,Sharpodonty:0};for(let p=Number(++r);p<=Number(u);p++){const $=n(b,d),w=p.toString(),R=$.Levels[w];R&&(x.Dust+=R.Dust,x.Sharpodonty+=R.Sharpodonty)}return x},i=s(t.currentInsight,t.goalInsight,t.info.Insight),h=s(t.currentResonance,t.goalResonance,t.info.Resonance),o=a(t),c=Se([i,h,o]);return tt(c)}const st={__name:"ArcanistCalculate",props:{arcanist:{type:Object,required:!0}},setup(t){const a=t,s=O(()=>{const n=a.arcanist;return Ce(n)});return(n,l)=>(m(),g("div",null,[C(Ze,{class:"max-h-48",materialList:s.value},null,8,["materialList"])]))}},at={class:"relative w-2/3 md:w-1/3 flex justify-center"},lt={key:0},nt=e("i",{class:"fa-regular fa-circle text-white"},null,-1),it=[nt],rt={key:1},ot=["src","alt"],ct=e("div",{class:"flex items-center justify-center"},[e("i",{class:"fa-solid fa-caret-up text-blue-500"})],-1),ut={class:"grid grid-cols-4 gap-1 p-3 border border-blue-300 rounded-md shadow-lg options-box custom-gradient-gray-blue"},dt=["onClick"],vt={class:"flex items-center justify-center font-semibold rounded-full w-8 h-8 leading-none flex-col bg-blue-500 text-white"},mt={key:0},ht=e("i",{class:"fa-regular fa-circle text-white"},null,-1),gt=[ht],ft={key:1},yt=["src","alt"],M={__name:"SelectList",props:{label:{type:String,required:!0},options:{type:Array,required:!0},selected:{type:Number}},emits:["update:selected"],setup(t,{emit:a}){const s=t,n=a,l=f(!1),i=f(s.selected),h=f(null),o=()=>{l.value=!0},c=()=>{l.value=!1},v=u=>{i.value=u,n("update:selected",u,s.label),l.value=!1},r=u=>`images/items/common/insight${u}.png`;return F(h,c),pe(()=>{s.selected===void 0?(i.value=s.options[0],n("update:selected",s.options[0],s.label)):(i.value=s.selected,n("update:selected",s.selected,s.label))}),(u,b)=>(m(),g("div",at,[e("button",{onClick:o,class:"btn btn-sm btn-ghost gradient-blue w-1/2 m-2"},[t.label==="Current Insight"||t.label==="Goal Insight"?(m(),g(L,{key:0},[i.value===0?(m(),g("div",lt,it)):(m(),g("div",rt,[e("img",{class:"avatar w-6",src:r(i.value),alt:"Option "+i.value},null,8,ot)]))],64)):(m(),g(L,{key:1},[X(S(i.value),1)],64))]),l.value?(m(),g("div",{key:0,ref_key:"containerRef",ref:h,class:"absolute mt-14 w-48 lg:w-64 z-50"},[ct,e("div",ut,[(m(!0),g(L,null,W(t.options,d=>(m(),g("button",{key:d,class:"m-1",onClick:x=>v(d)},[e("div",vt,[t.label==="Current Insight"||t.label==="Goal Insight"?(m(),g(L,{key:0},[d===0?(m(),g("div",mt,gt)):(m(),g("div",ft,[e("img",{src:r(d),alt:"Option "+d},null,8,yt)]))],64)):(m(),g(L,{key:1},[X(S(d),1)],64))])],8,dt))),128))])],512)):Q("",!0)]))}},pt={class:"edit-overlay"},_t={class:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-gray-800 to-blue-950 p-4 border-2 border-black rounded-md w-11/12 sm:max-w-2xl lg:h-auto"},bt={class:"flex items-center p-2 mb-3 shadow-border-b"},xt={class:"flex items-center justify-center mr-2 space-x-3"},$t={class:"text-1xl md:text-2xl text-white font-bold"},At={class:"text-sm text-white",for:"raritySelect"},wt={class:"ml-auto flex items-center space-x-3"},It={class:"tooltip","data-tip":"Hidden / Show"},kt=e("i",{class:"fas fa-times"},null,-1),St=[kt],Ct=e("div",{class:"custom-line"},null,-1),Rt=e("div",{class:"custom-label text-blue-100"},"Current Level",-1),Ot={class:"mt-2 flex justify-center items-center leading-none"},Nt=e("i",{class:"text-white text-center flex items-center justify-center font-extrabold text-2xl -translate-y-2"},"_",-1),Mt=e("div",{class:"custom-label text-blue-100"},"Goal Level",-1),Lt={class:"mt-2 flex justify-center items-center leading-none"},Dt=e("i",{class:"text-white text-center flex items-center justify-center font-extrabold text-2xl -translate-y-2"},"_",-1),Vt=e("div",{class:"custom-label text-blue-100"},"Resonance",-1),jt={class:"mt-2 flex justify-center items-center leading-none"},Ut=e("i",{class:"text-white fa-solid fa-angles-right text-center"},null,-1),qt={class:"flex justify-center space-x-4"},Pt={key:0,class:"toast toast-middle toast-center"},Gt=e("div",{class:"-translate-x-3 alert alert-info bg-red-300"},[e("span",null,"Current and Goal are the same!")],-1),Qt=[Gt],Wt={__name:"PlannerEdit",props:{selectedArcanist:{type:Object,required:!0},selectedArcanists:{type:Array,required:!0},listArcanists:{type:Array,required:!0}},emits:{closeOverlay:{type:Function,required:!0},updateSelectedArcanists:{type:Function,required:!0},updateListArcanists:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,l=f(!1),i=f(0),h=q().calculations.data,o=f(s.selectedArcanist.info),c=f(s.selectedArcanists),v=f(s.listArcanists),r=f(s.selectedArcanist.currentInsight),u=f(s.selectedArcanist.currentLevel),b=f(s.selectedArcanist.currentResonance),d=f(s.selectedArcanist.goalInsight),x=f(s.selectedArcanist.goalLevel),p=f(s.selectedArcanist.goalResonance),$=f(s.selectedArcanist.isVisible),w=O(()=>({info:o.value,isVisible:$.value,currentInsight:r.value,currentLevel:u.value,goalInsight:d.value,goalLevel:x.value,currentResonance:b.value,goalResonance:p.value})),R=O(()=>o.value.Rarity),D=O(()=>[0,...o.value.Insight.map(_=>_.Id)]),I=O(()=>D.value.filter(_=>_>=r.value)),N=O(()=>{const _=h.find(y=>y.Rarity.includes(o.value.Rarity)&&y.Insight==r.value);return _?[1,...Object.keys(_.Levels).map(Number).filter(y=>y%5===0)]:[]}),j=O(()=>{if(d.value===null)return[];const _=h.find(y=>y.Rarity.includes(o.value.Rarity)&&y.Insight==d.value);return _?d.value===r.value?[1,...Object.keys(_.Levels).map(Number).filter(y=>y%5===0)].filter(y=>y>=u.value):[1,...Object.keys(_.Levels).map(Number).filter(y=>y%5===0)]:[]}),P=O(()=>{if(r.value===null)return[];if(r.value===0)return b.value=0,[0];const _=Number(r.value);if(_===0)return b.value=null,null;const y=_*5;return Array.from({length:y},(k,B)=>Number(B+1))}),K=O(()=>{if(d.value===null)return[];if(d.value===0)return p.value=0,[0];const _=Number(d.value),y=Number(b.value);if(_===0)return p.value=null,null;const k=y||1,B=_*5;return Array.from({length:B-k+1},(ve,A)=>Number(k+A))}),E=(_,y,k,B)=>Number(_)>Number(k)?!0:Number(_)<Number(k)?!1:Number(y)>Number(B),ne=()=>{if(r.value===d.value&&u.value===x.value&&b.value===p.value)return l.value=!0,setTimeout(()=>{l.value=!1},1e3),!0;l.value=!1},Z=()=>{if(ne())return;const _=c.value.findIndex(y=>Number(y.info.Id)===Number(w.value.info.Id));_!==-1?c.value[_]={...c.value[_],...w.value}:c.value.push(w.value),v.value=v.value.filter(y=>y.Id!==w.value.info.Id),n("updateSelectedArcanists",c.value),n("updateListArcanists",v.value),n("closeOverlay")},ie=()=>{const _=c.value.findIndex(y=>Number(y.info.Id)===Number(w.value.info.Id));_!==-1&&c.value.splice(_,1),H()},H=()=>{n("closeOverlay")},G=(_,y)=>{switch(y){case"Current Insight":r.value=_;break;case"Current Level":u.value=_;break;case"Current Resonance":b.value=_;break;case"Goal Insight":d.value=_;break;case"Goal Level":x.value=_;break;case"Goal Resonance":p.value=_;break;case"Visible":$.value=_;break}};return he([r,u,b,d,x,p],()=>{i.value+=1}),he([r,u,b],()=>{E(r.value,u.value,d.value,x.value)&&(d.value=r.value,x.value=u.value),Number(b.value)>Number(p.value)&&(p.value=b.value)}),(_,y)=>(m(),g("div",pt,[e("div",_t,[e("div",bt,[e("div",xt,[C(Ae,{class:"ml-2",arcanist:o.value},null,8,["arcanist"]),e("h2",$t,S(o.value.Name),1),e("label",At,[X(S(R.value)+" ",1),e("i",{class:T(["fa-solid fa-star",{"text-orange-300":R.value===6,"text-yellow-100":R.value===5,"text-purple-400":R.value===4,"text-sky-200":R.value===3,"text-green-200":R.value===2}])},null,2)]),e("div",{class:"tooltip","data-tip":"Remove Arcanist"},[e("i",{onClick:ie,class:"fas fa-trash-alt text-gray-500"})])]),e("div",wt,[e("div",It,[e("div",{onClick:y[0]||(y[0]=k=>$.value=!$.value),class:T(["badge badge-ghost",$.value?"green-badge":"red-badge"])},[e("i",{class:T($.value?"fa-regular fa-eye":"fa-regular fa-eye-slash")},null,2)],2)]),e("button",{onClick:H,class:"text-white"},St)])]),Ct,Rt,e("div",Ot,[(m(),V(M,{key:i.value,modelValue:r.value,"onUpdate:modelValue":y[1]||(y[1]=k=>r.value=k),selected:r.value,label:"Current Insight",options:D.value,"onUpdate:selected":G},null,8,["modelValue","selected","options"])),Nt,(m(),V(M,{key:i.value,modelValue:u.value,"onUpdate:modelValue":y[2]||(y[2]=k=>u.value=k),selected:u.value,label:"Current Level",options:N.value,"onUpdate:selected":G},null,8,["modelValue","selected","options"]))]),Mt,e("div",Lt,[(m(),V(M,{key:i.value,modelValue:d.value,"onUpdate:modelValue":y[3]||(y[3]=k=>d.value=k),selected:d.value,label:"Goal Insight",options:I.value,"onUpdate:selected":G},null,8,["modelValue","selected","options"])),Dt,(m(),V(M,{key:i.value,modelValue:x.value,"onUpdate:modelValue":y[4]||(y[4]=k=>x.value=k),selected:x.value,label:"Goal Level",options:j.value,"onUpdate:selected":G},null,8,["modelValue","selected","options"]))]),Vt,e("div",jt,[(m(),V(M,{key:i.value,modelValue:b.value,"onUpdate:modelValue":y[5]||(y[5]=k=>b.value=k),selected:b.value,label:"Current Resonance",options:P.value,"onUpdate:selected":G},null,8,["modelValue","selected","options"])),Ut,(m(),V(M,{key:i.value,modelValue:p.value,"onUpdate:modelValue":y[6]||(y[6]=k=>p.value=k),selected:p.value,label:"Goal Resonance",options:K.value,"onUpdate:selected":G},null,8,["modelValue","selected","options"]))]),e("div",qt,[e("button",{onClick:Z,class:"btn btn-success"},"Save"),l.value?(m(),g("div",Pt,Qt)):Q("",!0)]),C(st,{arcanist:w.value},null,8,["arcanist"])])]))}},Bt=["data-tip"],Et={class:"rounded-md overflow-hidden"},Ft={class:"avatar"},Tt=["src","alt"],zt={__name:"ArcanistIconToggle",props:{arcanist:{type:Object,required:!0},visible:{type:Boolean,required:!0}},setup(t){const a=s=>`images/arcanists/icon/${s}.png`;return(s,n)=>(m(),g("div",{class:"tooltip","data-tip":t.arcanist.Name},[e("div",Et,[e("div",Ft,[e("div",{class:T(["w-12 rounded",{"filter-grayscale opacity-50":!t.visible,"bg-orange-300":t.arcanist.Rarity===6,"bg-yellow-100":t.arcanist.Rarity===5,"bg-purple-400":t.arcanist.Rarity===4,"bg-sky-200":t.arcanist.Rarity===3,"bg-green-200":t.arcanist.Rarity===2}])},[e("img",{src:a(t.arcanist.Id),alt:t.arcanist.Name},null,8,Tt)],2)])])],8,Bt))}},Kt=de(zt,[["__scopeId","data-v-11642327"]]),Ht={class:"flex flex-row flex-wrap justify-center space-x-2"},Jt=e("p",{class:"text-center text-slate-700 text-sm opacity-80"},"Left click to edit, right click to show / hide.",-1),Xt={__name:"PlannerSelector",props:{selectedArcanists:{type:Array,required:!0}},emits:["open-edit-overlay"],setup(t,{emit:a}){const s=t,n=a,l=f(s.selectedArcanists),i=o=>{n("open-edit-overlay",o)},h=o=>{o.isVisible=!o.isVisible};return(o,c)=>(m(),g("div",null,[e("div",Ht,[(m(!0),g(L,null,W(l.value,v=>(m(),V(Kt,{key:v.Name,arcanist:v.info,visible:v.isVisible,onClick:r=>i(v),onContextmenu:Oe(r=>h(v),["prevent"])},null,8,["arcanist","visible","onClick","onContextmenu"]))),128))]),Jt]))}},se=ae("warehouse",{state:()=>({isActive:!1,data:[],loaded:!1}),actions:{toggle(){this.isActive=!this.isActive},setData(t){this.data=t},setLoaded(){this.loaded=!0},addItem(t,a){this.data.push({Material:t,Quantity:0,Category:a})},updateItem(t,a){for(let s=0;s<this.data.length;s++)if(this.data[s].Material===t){this.data[s].Quantity=a;break}},reset(){this.data=[],this.loaded=!1}},persist:!0}),Y=q().items.data,ce=q().stages.data,Yt=q().crafts.data,Zt=se().data;function es(t){const a=t.map(s=>({...s}));return a.forEach(s=>{const n=Zt.find(l=>l.Material===s.Material);n&&(s.Quantity-=n.Quantity)}),a}function ts(t){let a=t.map(n=>({...n}));const s=[];return a.forEach(n=>{const l=Yt.find(i=>i.Name===n.Material);if(l){s.push(l);for(let i=0;i<l.Material.length;i++){const h=l.Material[i],o=l.Quantity[i]*n.Quantity;o>0&&(a.find(c=>c.Material===h)?a.find(c=>c.Material===h).Quantity+=o:a.push({Material:h,Quantity:o}))}}}),a=a.filter(n=>!s.some(l=>l.Name===n.Material)),a.sort((n,l)=>{const i=Y.find(o=>o.Name===n.Material);return Y.find(o=>o.Name===l.Material).Id-i.Id}),a}function ss(t){const s=Y.find(l=>l.Name===t.Material).Rarity,n=t.Quantity;return s===3?n*40:s===4?n*100:s===5?n*250:s===6?n*1500:0}function as(t){return t==="Oneiric Shop"?"images/items/common/1.png":"images/items/common/0.png"}function Re(t,a,s,n,l){return{stage:t,runs:isNaN(a)?0:a,activity:isNaN(s)?0:s,days:isNaN(n)?0:n,materials:l,activityImagePath:as(t)}}function ee(t,a){let s=a.find(n=>n.stage===t);return s||(s=Re(t,null,t==="Oneiric Shop"?0:null,null,[]),a.push(s)),s}function te(t){return t.sort((a,s)=>{const n=ce.find(i=>i.Name===a.stage),l=ce.find(i=>i.Name===s.stage);return n&&l?n.Id-l.Id:n?-1:l?1:0})}function ye(t){const a=[],s=es(t);ts(s).forEach(v=>{const r=ce.find(u=>u.Material.includes(v.Material));if(r){const u=Math.ceil(parseFloat(v.Quantity)/parseFloat(r.Quantity)),b=Math.ceil(u*r.Activity),d=(b/240).toFixed(1),x=v;if(x.Quantity>0){const p=a.findIndex($=>$.stage===r.Name);p!==-1?a[p].materials.push(x):a.push(Re(r.Name,u,b,d,[x]))}}else{const u=ee("Tier 3",a),b=ee("Tier 2",a),d=ee("Oneiric Shop",a),x=ee("Unreleased",a);if(Y.find(p=>p.Name===v.Material).Category==="Resonate Material")d.activity+=ss(v),d.materials.push(v);else{const p=Y.find(w=>w.Name===v.Material).Rarity;(p===3?u:p===2?b:x).materials.push(v)}}});const l=a.filter(v=>["The Poussiere VI","Mintage Aesthetics VI","Oneiric Shop"].includes(v.stage)&&v.materials.length>0),i=a.filter(v=>(v.stage.endsWith("II")||v.stage.endsWith("IV")||v.stage.endsWith("VI"))&&!l.some(r=>r.stage===v.stage)&&v.materials.length>0),h=a.filter(v=>!["Tier 2","Tier 3","Unreleased",...l.map(r=>r.stage),...i.map(r=>r.stage)].includes(v.stage)&&v.materials.length>0),o=a.filter(v=>["Tier 2","Tier 3","Unreleased"].includes(v.stage)&&v.materials.length>0);return[{id:0,cards:te(l)},{id:1,cards:te(i)},{id:2,cards:te(h)},{id:3,cards:te(o)}]}function ls(t){let a=0,s=0;return t.forEach(n=>{n.cards.forEach(l=>{l.days!==null&&(a+=l.activity,s+=parseFloat(l.days))})}),[a,s.toFixed(0)]}const ns={class:"bg-gray-700/40 shadow rounded flex flex-col items-center justify-between relative"},is={class:"stage text-white p-2"},rs={class:"calculations w-full flex justify-center items-center bg-gradient-to-r from-blue-800/70 to-blue-900/90 text-white p-2 rounded-md"},os={class:"border-blue-700/90 border-r pr-3"},cs={key:0},us=e("i",{class:"fa-solid fa-xmark text-xs mr-0.5"},null,-1),ds={key:1},vs={class:"pl-2"},ms=["src"],hs={class:"border-blue-700/90 border-l pl-3"},gs={class:"items-center flex"},fs={__name:"Card",props:{card:{type:Object,required:!0}},setup(t){return(a,s)=>(m(),g("div",ns,[e("div",is,[e("p",null,S(t.card.stage),1)]),e("div",rs,[e("p",os,[t.card.runs>0?(m(),g("span",cs,[us,X(S(t.card.runs),1)])):(m(),g("span",ds,S(t.card.runs),1))]),e("p",vs,S(t.card.activity==null?"?":t.card.activity),1),e("img",{src:t.card.activityImagePath,alt:"Activity Image",class:"inline-block w-8 h-8"},null,8,ms),e("p",hs,S(t.card.days)+" "+S(t.card.days===null?"":t.card.days>1?"days":"day"),1)]),e("div",gs,[(m(!0),g(L,null,W(t.card.materials,(n,l)=>(m(),g("div",{key:l},[C(Ie,{material:n},null,8,["material"])]))),128))])]))}},ys={class:"w-full mb-4 flex flex-col"},ps={class:"mb-4 gap-3 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4"},_s={__name:"PlannerLayer",props:{layer:{type:Object,required:!0}},setup(t){const a=t,s=O(()=>a.layer.cards&&a.layer.cards.length>0),n=O(()=>{switch(a.layer.id){case 0:return"yellow-badge";case 1:return"indigo-badge";case 2:return"purple-badge";case 3:return"green-badge";default:return"red-badge"}}),l=O(()=>{switch(a.layer.id){case 0:return"Resources";case 1:return"Insight";case 2:return"Hard Stages";case 3:return"Miscs";default:return"Undefined"}});return(i,h)=>(m(),g("div",ys,[s.value?(m(),g("div",{key:0,class:T(["badge badge-lg badge-ghost mt-2 mb-2 w-32",n.value])},S(l.value),3)):Q("",!0),e("div",ps,[(m(!0),g(L,null,W(t.layer.cards,(o,c)=>(m(),V(fs,{key:c,card:o},null,8,["card"]))),128))])]))}},bs={class:"flex flex-wrap"},xs={__name:"PlannerResult",props:{selectedArcanists:{type:Array,required:!0}},emits:["update:totalActivityAndDays"],setup(t,{emit:a}){const s=t,n=a,l=f([]),i=f([]);return _e(()=>{const h=s.selectedArcanists.map(c=>c.isVisible?Ce(c):[]),o=Se(h);l.value=o,n("update:totalActivityAndDays",ls(ye(o))),i.value=ye(o)}),(h,o)=>(m(),g("div",bs,[(m(!0),g(L,null,W(i.value,(c,v)=>(m(),V(_s,{key:v,layer:c},null,8,["layer"]))),128))]))}},$s="/Kornblume/images/items/common/0.png",As="/Kornblume/images/items/icon/55.png",ws="/Kornblume/images/items/icon/54.png",le=t=>(be("data-v-b116625d"),t=t(),xe(),t),Is={class:"flex custom-gradient-gray-blue-light px-2 py-2 md:px-4 lg:px-6 rounded-md items-center justify-center"},ks=le(()=>e("i",{class:"fa-solid fa-calculator text-white mr-3"},null,-1)),Ss={class:"tooltip flex items-center","data-tip":"Calculations hasn't been optimized"},Cs={class:"text"},Rs=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:$s,alt:"avatar"})])],-1)),Os={class:"text pr-3"},Ns={class:"tooltip","data-tip":"Wilderness Production"},Ms={class:"text"},Ls=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:As,alt:"avatar"})])],-1)),Ds={class:"tooltip","data-tip":"Wilderness Production"},Vs={class:"text"},js=le(()=>e("div",{class:"avatar"},[e("div",{class:"w-8 rounded"},[e("img",{src:ws,alt:"avatar"})])],-1)),Us={__name:"PlannerTotal",props:{totalActivityAndDays:{type:Array,required:!0},wildernessSettings:{type:Object,required:!0}},setup(t){return(a,s)=>(m(),g("div",Is,[ks,e("div",Ss,[e("div",Cs,S(t.totalActivityAndDays[0]),1),Rs,e("div",Os,S(t.totalActivityAndDays[1])+" "+S(t.totalActivityAndDays[1]>1?"days":"day"),1)]),e("div",Ns,[e("div",Ms,S(U(oe)(t.wildernessSettings.wildernessOutput.dust*t.totalActivityAndDays[1])),1)]),Ls,e("div",Ds,[e("div",Vs,S(U(oe)(t.wildernessSettings.wildernessOutput.gold*t.totalActivityAndDays[1])),1)]),js]))}},qs=de(Us,[["__scopeId","data-v-b116625d"]]),z=t=>(be("data-v-ffb65882"),t=t(),xe(),t),Ps={class:"list-overlay"},Gs={class:"custom-modal-small h-auto"},Qs=z(()=>e("i",{class:"fas fa-times"},null,-1)),Ws=[Qs],Bs=z(()=>e("div",{class:"custom-label text-yellow-100"},"Dust Bell Towers",-1)),Es={class:"grid grid-cols-3"},Fs=z(()=>e("div",{class:"custom-label text-yellow-100"},"Gold Bell Towers",-1)),Ts={class:"grid grid-cols-3"},zs=z(()=>e("div",{class:"custom-label text-yellow-100"},"Vigor",-1)),Ks={class:"grid grid-cols-2 p-2 items-center"},Hs={class:"tooltip","data-tip":"Collect once a day"},Js={class:"form-control"},Xs={class:"cursor-pointer label justify-center"},Ys=z(()=>e("span",{class:"label-text text-yellow-100 mr-3"},"Lazy Modo",-1)),Zs=["checked"],ea=z(()=>e("div",{class:"custom-label text-yellow-100"},"Output",-1)),ta={class:"grid grid-cols-2 p-2"},sa={class:"tooltip","data-tip":"Dust"},aa={class:"flex items-center justify-center gradient-blue text-center rounded-xl mx-5 lg:mx-2 h-8"},la={class:"tooltip","data-tip":"Sharpodonty"},na={class:"flex items-center justify-center gradient-blue text-center rounded-xl mx-5 lg:mx-2 h-8"},ia={__name:"PlannerWilderness",props:{settings:{type:Object,required:!0}},emits:{closeOverlay:{type:Function,required:!0},saveWildernessSettings:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,l=()=>{n("closeOverlay")},i=f(s.settings.dust1),h=f(s.settings.dust2),o=f(s.settings.dust3),c=f(s.settings.gold1),v=f(s.settings.gold2),r=f(s.settings.gold3),u=f(s.settings.vigor),b=f(s.settings.lazyModo),d=[0,1,2,3,4,5,6],x=[0,120,150,175,210,240,270],p=[0,60,75,80,96,108,120],$=(I,N)=>{switch(N){case"Dust 1":i.value=I;break;case"Dust 2":h.value=I;break;case"Dust 3":o.value=I;break;case"Gold 1":c.value=I;break;case"Gold 2":v.value=I;break;case"Gold 3":r.value=I;break}},w=()=>{const I=parseInt(u.value,10);if(isNaN(I)){u.value=null;return}if(I<0){u.value=0;return}if(I>50){u.value=50;return}u.value=I},R=()=>{const I={dust1:i.value,dust2:h.value,dust3:o.value,gold1:c.value,gold2:v.value,gold3:r.value,vigor:u.value,lazyModo:b.value,wildernessOutput:D.value};n("saveWildernessSettings",I),l()},D=O(()=>{const I=x[i.value]+x[h.value]+x[o.value],N=p[c.value]+p[v.value]+p[r.value],j=u.value?parseFloat(u.value/100):0,P=b.value?20:24,K=Math.ceil(I*(1+j)*P),E=Math.ceil(N*(1+j)*P);return{dust:K,gold:E}});return(I,N)=>(m(),g("div",Ps,[e("div",Gs,[e("button",{onClick:l,class:"absolute top-2 right-4 text-white"},Ws),Bs,e("div",Es,[C(M,{class:"select-list",options:d,selected:i.value,label:"Dust 1","onUpdate:selected":$},null,8,["selected"]),C(M,{class:"select-list",options:d,selected:h.value,label:"Dust 2","onUpdate:selected":$},null,8,["selected"]),C(M,{class:"select-list",options:d,selected:o.value,label:"Dust 3","onUpdate:selected":$},null,8,["selected"])]),Fs,e("div",Ts,[C(M,{class:"select-list",options:d,selected:c.value,label:"Gold 1","onUpdate:selected":$},null,8,["selected"]),C(M,{class:"select-list",options:d,selected:v.value,label:"Gold 2","onUpdate:selected":$},null,8,["selected"]),C(M,{class:"select-list",options:d,selected:r.value,label:"Gold 3","onUpdate:selected":$},null,8,["selected"])]),zs,e("div",Ks,[J(e("input",{onInput:w,"onUpdate:modelValue":N[0]||(N[0]=j=>u.value=j),type:"text",placeholder:"Vigor",class:"input input-bordered input-info input-sm mx-10 lg:mx-5 gradient-blue text-center"},null,544),[[ue,u.value]]),e("div",Hs,[e("div",Js,[e("label",Xs,[Ys,J(e("input",{"onUpdate:modelValue":N[1]||(N[1]=j=>b.value=j),type:"checkbox",checked:b.value,class:"checkbox checkbox-info"},null,8,Zs),[[$e,b.value]])])])])]),ea,e("div",ta,[e("div",sa,[e("label",aa,S(D.value.dust),1)]),e("div",la,[e("label",na,S(D.value.gold),1)])]),e("div",{class:"flex justify-center"},[e("button",{onClick:R,class:"btn btn-success"},"Save")])])]))}},ra=de(ia,[["__scopeId","data-v-ffb65882"]]),oa={class:"pb-6 z-50"},ca={class:"relative inline-block z-50"},ua=["src"],da=["src"],va={__name:"ItemWarehouse",props:{material:{type:Object,required:!0}},setup(t,{emit:a}){const s=t,n=a,l=f(s.material.Quantity),i=O(()=>we(s.material)),h=()=>{const c=parseInt(l.value,10);if(isNaN(c)||c<0){l.value=0;return}l.value=c},o=()=>{h(),n("update:quantity",l.value)};return(c,v)=>(m(),g("div",oa,[e("div",ca,[e("img",{src:i.value.borderImagePath,alt:"Border Image",class:"w-20 h-20 absolute object-contain"},null,8,ua),e("img",{src:i.value.itemImagePath,alt:"Material Image",class:"w-20 h-20 object-contain"},null,8,da),J(e("input",{"onUpdate:modelValue":v[0]||(v[0]=r=>l.value=r),onInput:o,type:"text",placeholder:"",class:"bg-slate-600 text-white absolute -bottom-3 left-3 w-14 input input-xs rounded-t-none text-center object-contain"},null,544),[[ue,l.value]])])]))}},ma={class:"list-overlay"},ha={class:"custom-modal-big h-5/6 lg:h-2/3 flex flex-col items-center"},ga=e("i",{class:"fas fa-times"},null,-1),fa=[ga],ya=e("p",{class:"text-white text-center font-bold"}," Warehouse ",-1),pa={class:"custom-scrollbar overflow-y-scroll overflow-x-hidden flex-grow"},_a={class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-8"},ba={__name:"PlannerWarehouse",emits:{closeOverlay:{type:Function,required:!0}},setup(t,{emit:a}){const s=a;let n=f(null),l=f([]);f({"Base Item":!0,"Build Material":!0,"Insight Material":!0,"Resonate Material":!0}),pe(()=>{const o=se().data;o.length===0&&(console.log("Setting up warehouse"),q().items.data.forEach(c=>{c.IsReleased==!0&&(c.Category==="Build Material"||c.Category==="Insight Material"||c.Category==="Resonate Material"||c.Name==="Dust"||c.Name==="Sharpodonty")&&se().addItem(c.Name,c.Category)})),l.value=o.slice(),ke(l.value),n.value=l.value});const i=(o,c)=>{n.value[o].Quantity=c,se().updateItem(n.value[o].Name,c)},h=()=>{s("closeOverlay")};return(o,c)=>(m(),g("div",ma,[e("div",ha,[e("button",{onClick:h,class:"absolute top-2 right-4 text-white"},fa),ya,e("div",pa,[e("div",_a,[(m(!0),g(L,null,W(U(n),(v,r)=>(m(),V(va,{class:"",key:r,material:v,"onUpdate:quantity":u=>i(r,u)},null,8,["material","onUpdate:quantity"]))),128))])])])]))}},xa={class:"list-overlay"},$a={class:"custom-modal-small h-auto space-y-5"},Aa=e("i",{class:"fas fa-times"},null,-1),wa=[Aa],Ia={class:"form-control"},ka={class:"cursor-pointer label justify-center space-x-5"},Sa=e("span",{class:"label-text text-white text-md"},"Show unreleased",-1),Ca={__name:"PlannerSettings",props:{settings:{type:Object,required:!0}},emits:{closeOverlay:{type:Function,required:!0},saveSettings:{type:Function,required:!0}},setup(t,{emit:a}){const s=t,n=a,l=f(s.settings.showUnreleased),i=()=>{n("closeOverlay")},h=()=>{const o={showUnreleased:l.value};n("saveSettings",o),i()};return(o,c)=>(m(),g("div",xa,[e("div",$a,[e("button",{onClick:i,class:"absolute top-2 right-4 text-white"},wa),e("div",Ia,[e("label",ka,[Sa,J(e("input",{"onUpdate:modelValue":c[0]||(c[0]=v=>l.value=v),type:"checkbox",class:"checkbox checkbox-info"},null,512),[[$e,l.value]])])]),e("div",{class:"flex justify-center"},[e("button",{onClick:h,class:"btn btn-success"},"Save")])])]))}},Ra={class:"responsive-spacer"},Oa=e("h2",{class:"text-2xl text-white font-bold mb-4 lg:mb-6"},"Planner",-1),Na=e("i",{class:"fa-solid fa-wand-magic-sparkles"},null,-1),Ma=e("i",{class:"fa-solid fa-tree"},null,-1),La=[Ma],Da=e("i",{class:"fa-solid fa-box-archive"},null,-1),Va=[Da],ja=e("i",{class:"fa-solid fa-gear"},null,-1),Ua=[ja],qa=e("div",{class:"custom-line"},null,-1),Pa=e("div",{class:"custom-line"},null,-1),Ga={key:0,class:"overlay"},Qa={key:1,class:"overlay"},Wa={key:2,class:"overlay"},Ba={key:3,class:"overlay"},Ea={key:4,class:"overlay"},za={__name:"PlannerView",setup(t){const a=Ne(),s=Me(),n=q().arcanists.data,l=Le(),i=f([]),h=O(()=>a.selectedArcanists.map(A=>A.info.Id));_e(()=>{i.value=n.filter(A=>!h.value.includes(A.Id)&&(l.settings.showUnreleased?!0:A.IsReleased)),i.value.sort((A,re)=>{const me=re.Rarity-A.Rarity;return me!==0?me:A.Name.localeCompare(re.Name)})});const o=f([]),c=f([]),v=f(!1),r=f(!1),u=f(!1),b=f(!1),d=f(!1),x=f(null),p=f(null),$=f(null),w=f(null),R=f(null),D=()=>{v.value=!0},I=()=>{v.value=!1},N=()=>{r.value=!0},j=A=>{o.value=A,N()},P=()=>{r.value=!1},K=()=>{u.value=!0},E=()=>{u.value=!1},ne=()=>{b.value=!0},Z=()=>{b.value=!1},ie=()=>{d.value=!0},H=()=>{d.value=!1},G=A=>{o.value={info:A,isVisible:!0,currentInsight:0,currentLevel:1,currentResonance:0,goalInsight:0,goalLevel:1,goalResonance:0},N()},_=A=>{a.selectedArcanists=A,P()},y=A=>{i.value=A},k=A=>{c.value=A},B=A=>{s.settings=A},ve=A=>{l.settings=A};return F(x,I),F(p,P),F($,E),F(w,Z),F(R,H),(A,re)=>(m(),g("div",Ra,[Oa,C(Xt,{selectedArcanists:U(a).selectedArcanists,onOpenEditOverlay:j},null,8,["selectedArcanists"]),e("div",{class:"flex justify-between items-center mb-2 mt-2"},[e("button",{onClick:D,class:"btn btn-ghost btn-sm custom-gradient-button"},[Na,X(" Add Arcanist")]),e("div",{class:"flex space-x-2"},[e("div",{class:"tooltip","data-tip":"Wilderness Settings"},[e("button",{onClick:K,class:"btn btn-ghost btn-sm custom-gradient-button"},La)]),e("div",{class:"tooltip","data-tip":"Manage Warehouse"},[e("button",{onClick:ne,class:"btn btn-ghost btn-sm custom-gradient-button"},Va)]),e("button",{onClick:ie,class:"btn btn-ghost btn-sm custom-gradient-button"},Ua)])]),qa,C(qs,{totalActivityAndDays:c.value,wildernessSettings:U(s).settings},null,8,["totalActivityAndDays","wildernessSettings"]),Pa,v.value?(m(),g("div",Ga,[C(Te,{ref_key:"arcanistListRef",ref:x,arcanists:i.value,onCloseOverlay:I,onSelectArcanist:G},null,8,["arcanists"])])):Q("",!0),r.value?(m(),g("div",Qa,[C(Wt,{ref_key:"plannerEditRef",ref:p,selectedArcanist:o.value,selectedArcanists:U(a).selectedArcanists,listArcanists:i.value,onCloseOverlay:P,onUpdateSelectedArcanists:_,onUpdateListArcanists:y},null,8,["selectedArcanist","selectedArcanists","listArcanists"])])):Q("",!0),u.value?(m(),g("div",Wa,[C(ra,{ref_key:"wildernessRef",ref:$,settings:U(s).settings,onCloseOverlay:E,onSaveWildernessSettings:B},null,8,["settings"])])):Q("",!0),b.value?(m(),g("div",Ba,[C(ba,{ref_key:"warehouseRef",ref:w,onCloseOverlay:Z},null,512)])):Q("",!0),d.value?(m(),g("div",Ea,[C(Ca,{ref_key:"settingsRef",ref:R,settings:U(l).settings,onCloseOverlay:H,onSaveSettings:ve},null,8,["settings"])])):Q("",!0),C(xs,{selectedArcanists:U(a).selectedArcanists,"onUpdate:totalActivityAndDays":k},null,8,["selectedArcanists"])]))}};export{za as default};
